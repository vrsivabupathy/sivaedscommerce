import{jsx as o}from"@dropins/tools/preact-jsx-runtime.js";import"@dropins/tools/event-bus.js";import{m as p,q as f,o as k}from"./fixtures.js";import{s as S}from"./setBillingAddress.js";import{classes as b}from"@dropins/tools/lib.js";import{Checkbox as _,Skeleton as v,SkeletonRow as A}from"@dropins/tools/components.js";/* empty css                      */import{useText as B}from"@dropins/tools/i18n.js";import{w as C}from"./withConditionalRendering.js";import{useState as I,useEffect as g}from"@dropins/tools/preact-compat.js";const x=({className:n,isInitialized:s=!0,checked:i=!0,...t})=>{const e=B({title:"Checkout.BillToShippingAddress.title"});return s?o("div",{className:b(["checkout-bill-to-shipping-address",n]),children:o(_,{"data-testid":"bill-to-shipping-checkbox",className:"checkout-bill-to-shipping-address__checkbox",checked:i,name:"checkout-bill-to-shipping-address__checkbox",label:e.title,...t})}):o(y,{})},y=()=>o(v,{className:"bill-to-shipping-address__skeleton",children:o(A,{variant:"row",size:"small"})}),m="is_bill_to_shipping_address";function T(n,s,i){const t=n[i],e=s[i];return t===void 0&&e===void 0||t===null&&e===null?!0:typeof t=="object"&&typeof e=="object"?JSON.stringify(t)===JSON.stringify(e):t===e}function N(n,s,i){return!s&&!i?!0:!s||!i?!1:n.every(t=>{const e=t.code;return T(s,i,e)})}const w=({isBillToShipping:n})=>{var d;const[s,i]=I(!1),t=k.value.data,e=f.value.data,h=(e==null?void 0:e.id)||"",l=!!e,a=e==null?void 0:e.billingAddress,r=(d=e==null?void 0:e.shippingAddresses)==null?void 0:d[0],c=!!r;return g(()=>{if(s)return;const u=localStorage.getItem(m);u&&(i(!0),n.value={checked:u==="true",setByUser:!1})},[s,n]),g(()=>{if(s||!t||!l)return;i(!0);const u=N(t,a,r);n.value={checked:a?u:n.value.checked,setByUser:!1}},[a,t,l,n,s,r]),{cartId:h,isInitialized:s,hasShippingAddress:c}},z=({children:n,...s})=>{const i=p.value.checked,{hasShippingAddress:t,isInitialized:e}=w({isBillToShipping:p});return o("div",{children:o(x,{...s,checked:i,isInitialized:e,onChange:l=>{const r=l.target.checked;if(p.value={checked:r,setByUser:!0},localStorage.setItem(m,r.toString()),!e||!r||!t)return;const c=new AbortController;return S({signal:c.signal,input:{same_as_shipping:!0}}).catch(d=>{console.error(d)}),()=>{c.abort()}},disabled:f.value.pending})})},V=C(z);export{V as B,m as a,N as c};
