import{events as E}from"@dropins/tools/event-bus.js";import{signal as o,effect as I}from"@dropins/tools/signals.js";import{FetchGraphQL as M}from"@dropins/tools/fetch-graphql.js";class G extends Error{constructor(s){super(s.map(t=>t.message).join(" ")),this.name="FetchError"}}class p extends Error{constructor(s){super(s),this.name="InvalidArgument"}}class $ extends Error{constructor(s){super(s),this.name="UnexpectedError"}}class J extends p{constructor(){super("Cart ID is required")}}class K extends p{constructor(){super("Email is required")}}class V extends p{constructor(){super("Payment method code is required")}}class ee extends p{constructor(){super("Billing address is required")}}class se extends p{constructor(){super("Country Code is required")}}const C=[];function L(e){return new Promise((s,t)=>{C.push(e);const a=()=>{C[0]===e?e().then(s).catch(t).finally(()=>C.shift()):setTimeout(a,100)};a()})}const x=["sender_email","recipient_email"];function A(e){return e.filter(s=>!s.path||!x.some(t=>{var a;return((a=s.path)==null?void 0:a.at(-1))===t}))}const S=e=>{throw e instanceof DOMException&&e.name==="AbortError"||E.emit("error",{source:"checkout",type:"network",error:e}),e},R=o({data:void 0,pending:!1}),O=o({checked:!0,setByUser:!1}),_=o({pending:!1,data:void 0});I(()=>{var e;(e=_.value.data)!=null&&e.isVirtual&&(O.value={checked:!1,setByUser:!1})});I(()=>{_.value.pending||E.emit("checkout/data",_.value.data||null)});const U=o({data:void 0,pending:!1}),h=o({pending:!1,data:void 0});I(()=>{h.value.pending||h.value.data&&E.emit("checkout/customer",h.value.data)});const X=o({pending:!1,data:void 0}),q=o({pending:!1,data:void 0}),te=o(void 0),ae=o(),b=o({data:void 0,pending:!1}),k={cart:_,customer:h,estimateShippingMethods:X,regions:q,storeConfig:b,countryList:U,addressFormFields:R};function w(e,s){return s.split(".").reduce((t,a)=>t&&t[a]!==void 0?t[a]:void 0,e)}const N={cart:null,customer:null,estimateShippingMethods:null,regions:null,storeConfig:null,countryList:null,addressFormFields:null};async function P(e){const{defaultValueOnFail:s,query:t,options:a,path:l,signalType:c,type:T,transformer:f}=e,r=k[c],v=Symbol();N[c]=v,r.value={...r.value,pending:!0};try{const{data:g,errors:y}=await(T==="mutation"?L(()=>m(t,a).catch(S)):m(t,{method:"GET",cache:"no-cache",...a}).catch(S));if(y){const D=A(y);if(D.length>0)throw new G(D)}let u=w(g,l);if(u===void 0)throw new Error(`No data found at path: ${l}`);return f&&(u=f(u)),r.value={...r.value,data:u},setTimeout(()=>{r.value={...r.value,pending:N[c]===v?!1:r.value.pending}},0),u}catch(g){if(s)return r.value={pending:!1,data:s},s;if(g.name==="AbortError")return;throw r.value={...r.value,pending:!1},g}}const F={cartId:null,authenticated:!1},ie=new Proxy(F,{set(e,s,t){return e[s]=t,!0},get(e,s){return e[s]}}),H=`
  query getStoreConfig {
    storeConfig {
      countries_with_required_region
      default_country
      display_state_if_optional
      is_guest_checkout_enabled
      is_one_page_checkout_enabled
      locale
      optional_zip_countries
      shopping_cart_display_shipping
      store_code
    }
  }
`;var d=(e=>(e.EXCLUDING_TAX="EXCLUDING_TAX",e.INCLUDING_EXCLUDING_TAX="INCLUDING_AND_EXCLUDING_TAX",e.INCLUDING_TAX="INCLUDING_TAX",e))(d||{});const W="US",n={defaultCountry:W,countriesWithRequiredRegion:[],displayStateIfOptional:!1,countriesWithOptionalZipCode:[],isGuestCheckoutEnabled:!1,isOnePageCheckoutEnabled:!1,shoppingCartDisplaySetting:{shipping:d.EXCLUDING_TAX}},re=async()=>await P({type:"query",query:H,options:{method:"GET",cache:"no-cache"},path:"storeConfig",signalType:"storeConfig",transformer:Q,defaultValueOnFail:n});function B(e){switch(e){case 1:return d.EXCLUDING_TAX;case 2:return d.INCLUDING_TAX;case 3:return d.INCLUDING_EXCLUDING_TAX;default:return d.EXCLUDING_TAX}}function Q(e){if(!e)return n;const{default_country:s,countries_with_required_region:t,display_state_if_optional:a,optional_zip_countries:l,is_guest_checkout_enabled:c,is_one_page_checkout_enabled:T,shopping_cart_display_shipping:f}=e;return{defaultCountry:s||n.defaultCountry,countriesWithRequiredRegion:(t==null?void 0:t.split(","))||n.countriesWithRequiredRegion,displayStateIfOptional:a||n.displayStateIfOptional,countriesWithOptionalZipCode:(l==null?void 0:l.split(","))||n.countriesWithOptionalZipCode,isGuestCheckoutEnabled:c||n.isGuestCheckoutEnabled,isOnePageCheckoutEnabled:T||n.isOnePageCheckoutEnabled,shoppingCartDisplaySetting:{shipping:B(f)}}}const{setEndpoint:oe,setFetchGraphQlHeader:ne,removeFetchGraphQlHeader:le,setFetchGraphQlHeaders:de,fetchGraphQl:m,getConfig:ce}=new M().getMethods();var i=(e=>(e.Boolean="BOOLEAN",e.Date="DATE",e.Datetime="DATETIME",e.File="FILE",e.Gallery="GALLERY",e.Hidden="HIDDEN",e.Image="IMAGE",e.MediaImage="MEDIA_IMAGE",e.Multiline="MULTILINE",e.Multiselect="MULTISELECT",e.Price="PRICE",e.Select="SELECT",e.Text="TEXT",e.Textarea="TEXTAREA",e.Undefined="UNDEFINED",e.Weight="WEIGHT",e))(i||{}),Z=(e=>(e.DateRangeMax="DATE_RANGE_MAX",e.DateRangeMin="DATE_RANGE_MIN",e.FileExtensions="FILE_EXTENSIONS",e.InputValidation="INPUT_VALIDATION",e.MaxFileSize="MAX_FILE_SIZE",e.MaxImageHeight="MAX_IMAGE_HEIGHT",e.MaxImageWidth="MAX_IMAGE_WIDTH",e.MaxTextLength="MAX_TEXT_LENGTH",e.MinTextLength="MIN_TEXT_LENGTH",e))(Z||{});const ue=[{frontendInput:i.Text,code:"firstname",label:"First Name",isRequired:!0,isDisabled:!1,options:[],validateRules:[],sortOrder:10},{frontendInput:i.Text,code:"lastname",label:"Last Name",isRequired:!0,isDisabled:!1,options:[],validateRules:[],sortOrder:20},{frontendInput:i.Text,code:"company",label:"Company",isRequired:!1,isDisabled:!1,options:[],validateRules:[],sortOrder:30},{frontendInput:i.Multiline,code:"street",label:"Street Address",isRequired:!0,isDisabled:!1,options:[],validateRules:[],sortOrder:40},{frontendInput:i.Text,code:"city",label:"City",isRequired:!0,isDisabled:!1,options:[],validateRules:[],sortOrder:50},{frontendInput:i.Select,code:"country_id",label:"Country",isRequired:!0,isDisabled:!1,options:[{text:"United States",value:"US"},{text:"Spain",value:"ES"},{text:"France",value:"FR"}],validateRules:[],sortOrder:60},{frontendInput:i.Text,code:"region",label:"State/Province",isRequired:!1,isDisabled:!1,options:[],validateRules:[],sortOrder:70},{frontendInput:i.Hidden,code:"region_id",label:"State/Province",isRequired:!1,isDisabled:!1,options:[],validateRules:[],sortOrder:80},{frontendInput:i.Text,code:"postcode",label:"Zip/Postal Code",isRequired:!1,isDisabled:!1,options:[],validateRules:[],sortOrder:90},{frontendInput:i.Text,code:"telephone",label:"Phone Number",isRequired:!0,isDisabled:!1,options:[],validateRules:[],sortOrder:100},{frontendInput:i.Text,code:"vat_id",label:"VAT Number",isRequired:!1,isDisabled:!1,options:[],validateRules:[],sortOrder:110}];export{i as A,W as D,G as F,p as I,J as M,n as S,d as T,$ as U,Z as V,K as a,V as b,ee as c,se as d,ne as e,de as f,m as g,ce as h,ue as i,re as j,ie as k,P as l,O as m,ae as n,R as o,h as p,_ as q,le as r,oe as s,b as t,S as u,te as v,X as w,q as x,U as y};
