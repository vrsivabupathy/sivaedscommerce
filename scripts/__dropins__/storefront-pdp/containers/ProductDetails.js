import{jsxs as j,jsx as r,Fragment as ye}from"@dropins/tools/preact-jsx-runtime.js";import*as be from"@dropins/tools/preact-compat.js";import{useState as Y,Children as de,useRef as Ne,useMemo as Se,useEffect as J,useCallback as le}from"@dropins/tools/preact-compat.js";import{debounce as xe,classes as R,VComponent as G,toLanguageTag as ke,Slot as Q}from"@dropins/tools/lib.js";import{Button as ve,Icon as we,Price as ge,Picker as He,ColorSwatch as qe,ImageSwatch as je,TextSwatch as Xe,Incrementer as Fe,Breadcrumbs as De,Image as Oe}from"@dropins/tools/components.js";import{useText as K}from"@dropins/tools/i18n.js";import{cloneElement as Ge}from"@dropins/tools/preact.js";import{c as Re,d as Te}from"../chunks/getRefinedProduct.js";import{events as Le}from"@dropins/tools/event-bus.js";import{c as Be}from"../chunks/initialize.js";import"@dropins/tools/fetch-graphql.js";const Ye=t=>be.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},be.createElement("path",{d:"M7.74512 9.87701L12.0001 14.132L16.2551 9.87701",stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"square",strokeLinejoin:"round"})),Ve=t=>be.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},be.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M18.3599 5.64001L5.62988 18.37",stroke:"currentColor"}),be.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M18.3599 18.37L5.62988 5.64001",stroke:"currentColor"})),Ke=24,Me=16,fe=2,Ze="32";var We=(t=>(t[t.small=16]="small",t[t.medium=24]="medium",t[t.large=64]="large",t))(We||{});const Pe=({show:t=1,scrollbar:o=!1,peak:h=!1,arrows:u=!1,controls:i="dots",arrowsOnMainImage:f=!1,loop:d=!1,gap:v=null,direction:l="horizontal",width:X="100%",height:c="100%",defaultIndex:m=0,className:T,children:M,thumbnails:U=null,isZoomed:te,...b})=>{const P=K("PDP.Carousel.label").label,n=K("PDP.Carousel.Slide.label").label,y=K("PDP.Carousel.Previous.label").label,x=K("PDP.Carousel.Next.label").label,E=K("PDP.Carousel.Controls.label").label,S=K("PDP.Carousel.Controls.Button.label").label,[A,he]=Y(()=>Ee(t)),e=Math.ceil(de.count(M)/A),I=h?Ke:0,g=v?We[v]:0,z=de.count(M)%A,[D,ee]=Y(d?m+1:m),k=Ne([]),[ne,ae]=Y(0),[ce,_e]=Y(0),ue=Se(()=>de.toArray(U),[U]),B=Se(()=>{const a=de.toArray(M).reduce((p,L,O)=>O%A===0?[...p,[L]]:[...p.slice(0,-1),[...p[p.length-1],L]],[]);return!d||a.length===1?a:d&&de.count(M)%A===0?[a[e-1]].concat(a).concat([a[0],a[1]]):[de.toArray(M).slice(-A)].concat(a).concat([a[0],a[1]])},[M,A,e,d]),re=Ne(null),ie=Ne(null),N=i==="thumbnailsRow"||i==="thumbnailsColumn";J(()=>{const a=document.body,p=xe(()=>{var q,oe;ae(((q=re.current)==null?void 0:q.offsetWidth)??0),_e(((oe=re.current)==null?void 0:oe.offsetHeight)??0);const O=window.innerWidth,F=Ee(t,O);F!==A&&he(F)},50),L=new ResizeObserver(p);return L.observe(a),()=>{L.unobserve(a)}},[A,t]);const Z=le(a=>{const p=d?a-1:a,L=k==null?void 0:k.current[0],O=(L==null?void 0:L.offsetWidth)+Me,F=(L==null?void 0:L.offsetHeight)+Me,q=ie.current,oe=i==="thumbnailsRow",Ae=i==="thumbnailsColumn",me=oe?q==null?void 0:q.offsetWidth:q==null?void 0:q.offsetHeight,C=oe?O:F;(oe||Ae)&&me&&(C*(p+1)>me&&(q.style.scrollBehavior="smooth",oe?q.scrollLeft=(p+fe)*C:q.scrollTop=(p+fe)*C),(oe?q.scrollLeft:q.scrollTop)>C*p&&(q.style.scrollBehavior="smooth",oe?q.scrollLeft=(p-fe)*C:q.scrollTop=(p-fe)*C))},[i,d]);J(()=>{Z(D)},[D,Z]);const H=le((a,p,L)=>{N&&Z(a);const O=re.current,F=I?O.offsetWidth-I:O.offsetWidth-I+g;if(!Array.from(O.querySelectorAll("[data-index]")).filter(me=>{const C=Number(me.getAttribute("data-index"));return!isNaN(C)&&C>-1})[a])return;if(L){const me=a===0?e:0,C=F*(e+(z||A)/A);if(O.scrollLeft>=0&&O.scrollLeft<F-5){H(1,!0);return}if(O.scrollLeft>C-F&&O.scrollLeft<=C){H(e,!0);return}O.style.scrollBehavior="auto",O.scrollLeft=me===0?0:C,H(me===0?1:e,!0);return}const Ae=(O.offsetWidth-g)/A*B[a].length-I;O.style.scrollBehavior=p?"smooth":"auto",O.scrollLeft=B[a].length===A?F*a:F*(a-1)+Ae},[g,e,I,A,z,B,Z,i]),pe=le(()=>{if(d){const p=D-1;H(p,!0,D===1);return}const a=D<=0?0:D-1;H(a,!0)},[D,H,d]),s=le(()=>{const a=B.length-1;if(d){const L=D+1;H(L,!0,D===e);return}const p=D>=a?a:D+1;H(p,!0)},[B.length,d,D,H,e]);J(()=>{const a=p=>{p.key==="ArrowLeft"&&(p.preventDefault(),pe()),p.key==="ArrowRight"&&(p.preventDefault(),s())};return window.addEventListener("keydown",a),()=>{window.removeEventListener("keydown",a)}},[s,pe]),J(()=>{H(d?m+1:m,!1)},[m,H,d]);const _=xe(()=>{const a=re.current,p=I?a.offsetWidth-I:a.offsetWidth-I+g,L=a.scrollLeft/p,O=Math.round(L)-L<1?Math.round(L):Math.ceil(L);if(N&&Z(O),d){const F=p*(e+(z||A)/A);if(Math.ceil(a.scrollLeft)>=Math.ceil(F)-5){a.style.scrollBehavior="auto",a.scrollLeft=a.offsetWidth*1+(Math.ceil(a.scrollLeft)-Math.ceil(F)-I);return}if(a.scrollLeft===0){a.style.scrollBehavior="auto",a.scrollLeft=F-a.offsetWidth+I;return}}D!==O&&ee(O)},100);J(()=>{const a=re.current;return a==null||a.addEventListener("scroll",_),()=>{a==null||a.removeEventListener("scroll",_)}},[_]);const w=(a,p,L)=>r(ve,{className:R([["pdp-carousel__button",!a],[`pdp-carousel__button--${p}`,!a],[`pdp-carousel__button--${i}`,a]]),style:{"--height":`${ce}px`},variant:"tertiary","aria-label":p==="next"?x:y,onClick:L,disabled:d?!1:p==="next"?D>=B.length-1:D<1,children:r(we,{className:R([["pdp-carousel__button__icon",!a],[`pdp-carousel__button__icon--${p}`,!a],[`pdp-carousel__button__icon--${i}--${p}`,a]]),size:Ze,source:Ye})}),V=u&&B.length!=1&&w(N,"prev",pe),W=u&&B.length!=1&&w(N,"next",s),$=u&&B.length!=1&&w(!1,"prev",pe),se=u&&B.length!=1&&w(!1,"next",s);return j("div",{role:"region","aria-roledescription":P,className:R(["pdp-carousel",["pdp-carousel--main-image-controls",f],["pdp-carousel--arrows",u&&!N],[`pdp-carousel--${i}`,N],T]),style:{"--flex-carousel":i==="thumbnailsColumn"?"row-reverse":"column","--gap":N?"0":"var(--spacing-small)","--width":X},...b,children:[r("div",{ref:re,className:R(["pdp-carousel__wrapper",`pdp-carousel__wrapper--${l}`,["pdp-carousel__wrapper--scrollbar",o],["pdp-carousel__wrapper--peak",h]]),style:{"--total-width":i==="thumbnailsColumn"?"81.6%":"100%","--height":i==="thumbnailsColumn"?"auto":c,"--gap":v?`var(--spacing-${v})`:"0px","--per-page":A},tabIndex:0,children:B.map((a,p)=>{const L=a.length<A;return r("div",{role:"group","aria-roledescription":n,"data-index":p,className:R(["pdp-carousel__slide",`pdp-carousel__slide--${l}`,["pdp-carousel__slide--active",D===p],["pdp-carousel__slide--orphan",L]]),style:{"--length":a.length},children:a},p)})}),!N&&j(ye,{children:[V,W]}),N&&f&&j(ye,{children:[$,se]}),i&&B.length!=1&&j("div",{className:R([[`pdp-carousel__controls__container--${i}`,N],["pdp-carousel__controls__container--no-arrows",!u||f]]),style:{"--width":i==="thumbnailsRow"?`${ne}px`:X,"--height":`${ce}px`,"--nr-thumbnails":ue.length},children:[(N||te)&&!f&&V,r("div",{ref:ie,className:R([[`pdp-carousel__controls__wrapper--${i}`,N],["pdp-carousel__controls__wrapper",N]]),children:r("div",{role:"group","aria-label":E,className:R(["pdp-carousel__controls",[`pdp-carousel__controls--${i}`,N]]),children:(d?B.slice(0,e):B).map((a,p)=>{const L=d?e:B.length,O=d?D-1===p:D===p;return N?j("label",{className:R(["pdp-carousel__thumbnail__container"]),ref:F=>{F&&(k.current[p]=F)},children:[r("input",{type:"radio",name:"carousel-thumbnails","aria-label":S.replace("{key}",String(p+1)).replace("{total}",String(L)),checked:O&&ne!==0,onChange:()=>{H(d?p+1:p,!0)},...b,className:R(["pdp-carousel__thumbnail",["pdp-carousel__thumbnail--selected",O&&ne!==0]])}),r("span",{className:R(["pdp-carousel__thumbnail__span"]),children:ue[p]})]},p):r("button",{"aria-label":S.replace("{key}",String(p+1)).replace("{total}",String(L)),onClick:()=>{H(d?p+1:p,!0)},className:R(["pdp-carousel__controls__button",["pdp-carousel__controls__button--active",O]])},p)})})}),(N||te)&&!f&&W]})]})};function Ee(t,o=0){if(typeof t=="number")return t;const{small:h,medium:u,large:i}=t,d=[{breakpoint:1024,value:i},{breakpoint:786,value:u},{breakpoint:0,value:h}].find(({breakpoint:v})=>o>v);return d?d.value:h}const Qe=({title:t,breadcrumbs:o,galleryContent:h,infoContent:u,productContent:i,sku:f,outOfStock:d,shortDescription:v,description:l,attributes:X,images:c,options:m,price:T,specialPrice:M,className:U,children:te,quantity:b,actions:P,carouselConfig:n,zoomType:y="overlay",closeButton:x=!0,...E})=>{var ee,k,ne,ae,ce,_e,ue,B,re;const S=K("PDP.Product.RegularPrice.label").label,A=K("PDP.Product.SpecialPrice.label").label,he=K("PDP.Product.OutOfStock.label").label,e=K("PDP.Product.Image.label").label,[I,g]=Y(null),z=c!=null&&c.length?c.map((ie,N)=>{var H;const Z=((H=t==null?void 0:t.props)==null?void 0:H.children)&&(e==null?void 0:e.replace("{product}",t.props.children.toString()).replace("{key}",String(N+1)).replace("{total}",String(c.length)));return y==="zoom"?r(lt,{closeButton:x,children:r(G,{node:ie,loading:N===0?"eager":"lazy",alt:Z},N)}):r(G,{node:ie,loading:N===0?"eager":"lazy",alt:Z,onClick:()=>g(N)},N)}):r("img",{src:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",className:"pdp-product__images__placeholder","aria-hidden":!0}),D=(ee=n==null?void 0:n.thumbnails)!=null&&ee.length?n.thumbnails.map((ie,N)=>{var Z;return r(G,{node:ie,loading:(n==null?void 0:n.thumbnailsLoadingMode)||"lazy",alt:((Z=t==null?void 0:t.props)==null?void 0:Z.children)&&(e==null?void 0:e.replace("{product}",t.props.children.toString()).replace("{key}",String(N+1)).replace("{total}",String(c.length)))},N)}):r("img",{src:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",className:"pdp-product__images__placeholder","aria-hidden":!0});return j("div",{...E,className:R(["pdp-product",U]),children:[o&&r(G,{node:o,className:"pdp-product__breadcrumbs"}),j("div",{className:"pdp-product__column-container pdp-product__gallery-column",children:[r("div",{className:"pdp-product__column-body",children:(k=n==null?void 0:n.controls)!=null&&k.desktop?r(Pe,{className:"pdp-product__overlay__carousel",arrows:(c==null?void 0:c.length)>1,controls:(c==null?void 0:c.length)>1?n.controls.desktop:"dots",arrowsOnMainImage:n==null?void 0:n.arrowsOnMainImage,loop:(n==null?void 0:n.loopable)&&(c==null?void 0:c.length)>1,peak:((ne=n==null?void 0:n.thumbnails)==null?void 0:ne.length)>1&&((ae=n==null?void 0:n.peak)==null?void 0:ae.desktop)||!1,gap:(n==null?void 0:n.gap)||null,width:"100%",height:"100%",defaultIndex:I||0,thumbnails:D,children:z}):r(Je,{className:"pdp-product__images",gap:"small",children:z})}),h&&r(G,{node:h,className:"pdp-product__gallery-content"})]}),j("div",{className:"pdp-product__column-container pdp-product__content-column",children:[j("div",{className:"pdp-product__column-body",children:[j("div",{className:"pdp-product__header",children:[t&&r(G,{node:t,className:"pdp-product__title"}),f&&r(G,{node:f,className:"pdp-product__sku"})]}),j("div",{className:"pdp-product__prices",children:[M&&r(G,{node:M,className:R(["pdp-product__price-special","pdp-product__price"]),"aria-label":A,role:"text"}),T&&r(G,{node:T,className:R(["pdp-product__price-regular","pdp-product__price--grey"]),"aria-label":S,role:"text"})]}),(ce=n==null?void 0:n.controls)!=null&&ce.mobile&&((_e=n==null?void 0:n.controls)==null?void 0:_e.mobile)==="thumbnailsRow"?r(Pe,{className:"pdp-product__images pdp-product__images--carousel pdp-product__images--carousel--thumbnails",width:"100%",height:"auto",arrows:(c==null?void 0:c.length)>1,controls:(c==null?void 0:c.length)>1?"thumbnailsRow":null,loop:(n==null?void 0:n.loopable)&&(c==null?void 0:c.length)>1,peak:((ue=n==null?void 0:n.thumbnails)==null?void 0:ue.length)>1&&((B=n==null?void 0:n.peak)==null?void 0:B.mobile)||!1,gap:(n==null?void 0:n.gap)||null,thumbnails:D,children:z}):r(Pe,{className:"pdp-product__images pdp-product__images--carousel",peak:((re=n==null?void 0:n.peak)==null?void 0:re.mobile)&&(c==null?void 0:c.length)>1,gap:(n==null?void 0:n.gap)||null,width:"100%",height:"auto",arrows:(c==null?void 0:c.length)>1,controls:(c==null?void 0:c.length)>1?"dots":null,loop:(n==null?void 0:n.loopable)&&(c==null?void 0:c.length)>1,children:z}),j("div",{className:R(["pdp-product__actions",["pdp-product__actions--out-of-stock",d]]),children:[d&&r("div",{className:"pdp-product__out-of-stock__text",children:he}),m&&r(G,{node:m,className:R(["pdp-product__options"])}),b&&r("div",{className:"pdp-product__quantity",children:r(G,{node:b})}),P&&r(G,{node:P,className:R(["pdp-product__buttons"])})]}),v&&r(G,{node:v,className:R(["pdp-product__short_description"])}),l&&r(G,{node:l,className:R(["pdp-product__description"])}),X?r("div",{className:"pdp-product__attributes",children:X}):null]}),u&&r(G,{node:u,className:"pdp-product__info-content"})]}),i&&r(G,{node:i,className:"pdp-product__content"}),I===null?null:r(Ce,{className:"pdp-product__overlay",onClose:()=>g(null),centered:!0,children:r(Pe,{className:"pdp-product__overlay__carousel",arrows:(c==null?void 0:c.length)>1,width:"100%",height:"100%",defaultIndex:I||0,loop:(n==null?void 0:n.loopable)&&(c==null?void 0:c.length)>1,controls:(c==null?void 0:c.length)>1?"dots":null,isZoomed:!0,children:z})})]})},Je=({children:t,gap:o=null,className:h,style:u,...i})=>{const f=de.count(t);return r("div",{...i,className:R(["pdp-gallery-grid",h]),style:{"--gap":o?`var(--spacing-${o})`:"0px",...u},children:de.map(t,(d,v)=>r("div",{className:"pdp-gallery-grid__item",children:r(G,{node:d,loading:v===0?"eager":"lazy"},d.props.src)},f+v))})},Ie=({amount:t,currency:o,locale:h,variant:u,sale:i,minimumAmount:f,maximumAmount:d,className:v,...l})=>r(ye,{children:t||f===d?r("div",{className:"pdp-price-range",...l,children:r(ge,{amount:t||f,currency:o,locale:h,variant:u,sale:i,className:v})}):j("div",{className:"pdp-price-range",...l,children:[r(ge,{amount:f,currency:o,locale:h,className:v}),r("span",{className:"pdp-price-range__label",children:"-"}),r(ge,{amount:d,currency:o,locale:h,className:v})]})}),Ce=({centered:t,onClose:o,className:h,children:u,...i})=>{const f=K("PDP.Overlay.Close.label").label,d=le(()=>{o==null||o()},[o]);return J(()=>{const v=l=>{l.key==="Escape"&&d()};return document.addEventListener("keydown",v),()=>{document.removeEventListener("keydown",v)}},[d]),J(()=>{const v=document.scrollingElement,l=v.style.overflow;return v.style.overflow="hidden",()=>{v.style.overflow=l}},[]),j("div",{...i,className:R(["pdp-overlay",["pdp-overlay--centered",t],h]),children:[r("div",{className:"pdp-overlay__content",children:u}),r(ve,{"aria-label":f,variant:"tertiary",className:"pdp-overlay__close-button",onClick:d,icon:r(Ve,{})})]})},et=["text","image","color","dropdown"],tt=t=>t.map(o=>({...o,text:o.label,disabled:!o.inStock}));function nt(t,o){return t.reduce((h,u)=>{const i=o==null?void 0:o.find(d=>d.items.find(v=>v.id===u));if(!i)return h;const f=i.items.find(d=>d.id===u);return{...h,[i.id]:{label:f.label,value:f.id}}},{})}const rt=({options:t,hideSelectedValue:o,selectedUIDs:h,onValues:u,onErrors:i,defaultOptions:f,selectionsToUpdate:d,className:v,children:l,...X})=>{const c=K("PDP.Swatches.Required.label").label,[m,T]=Y(()=>t==null?void 0:t.reduce((P,n)=>{const{items:y}=n,x=y==null?void 0:y.find(S=>f==null?void 0:f.includes(S.id)),E=y==null?void 0:y.find(S=>S.selected);return x?{...P,[n.id]:{label:x.label,value:x.id}}:E?{...P,[n.id]:{label:E.label,value:E.id}}:P},{}));J(()=>{if(h){const b=nt(h,t);if(JSON.stringify(b)===JSON.stringify(m))return;M(Object.keys(b)[0],b[Object.keys(b)[0]].label,h[0])}},[h]),J(()=>{d==null||d.forEach(b=>{T(P=>{var x;const n=(x=b==null?void 0:b.items)==null?void 0:x.find(E=>E.selected);return n?{...P,[b.id]:{label:n==null?void 0:n.label,value:n==null?void 0:n.id}}:P})})},[d,T]),Se(()=>{const b=t==null?void 0:t.reduce((P,n)=>{var x;let y=!1;return(x=n==null?void 0:n.items)==null||x.forEach(E=>{var A;((A=m[n.id])==null?void 0:A.value)===E.id&&(y=!0)}),n.required&&!y&&(P[n.id]=c),P},{});return i==null||i(b),b},[m]);const M=le((b,P,n)=>{console.log("===================handleOnSelection===================",b,P,n),T(y=>{const x={...y,[b]:{label:P,value:n}};return u==null||u(x,n),x}),console.log("===================------------------===================")},[u]),U=(b,P)=>{var y;console.log("===================handlePickerSelect===================");const n=((y=P.selectedOptions[0])==null?void 0:y.label)??"";M(b,n,P.value),console.log("========================================================")},te=le(({items:b,id:P,required:n,type:y,selected:x,label:E})=>(b==null?void 0:b.length)>0&&r("div",{className:R(["pdp-swatches__options"]),children:(y==null?void 0:y.toLowerCase())==="dropdown"?r(He,{"aria-label":E,handleSelect:S=>U(P,S.target),options:tt(b),value:x}):b==null?void 0:b.map(S=>{const A={key:S.id,id:S.id,name:P,value:S.value,label:S.label,groupAriaLabel:E,selected:x===S.id,outOfStock:!S.inStock,required:n===null?!0:n,onValue:()=>{M(P,S.label,S.id)}};switch(y){case"text":return r(Xe,{...A,label:S.label});case"image":return r(je,{...A,src:S.value,alt:S.label});case"color":return r(qe,{...A,size:"large",color:S.value});default:return console.warn(`Invalid swatch type ${y}`),null}})}),[M]);return r("div",{...X,className:R(["pdp-swatches",v]),children:t==null?void 0:t.map(({type:b,label:P,id:n,multiple:y,required:x,items:E})=>{var S;return et.includes(b)||console.warn(`Invalid swatch type ${b}`),y&&console.warn("Multiple selection swatches are not currently supported."),j("div",{id:`swatch-item-${n}`,"data-slot-key":`product-swatch--${n}`,className:"pdp-swatches__field",children:[r("div",{className:"pdp-swatches__field__label",children:m[n]?o?`${P}`:`${P}: ${m[n].label}`:P}),r(te,{id:n,type:b,required:x,items:E,label:P,selected:(S=m[n])==null?void 0:S.value})]},`swatch-item-${n}`)})})},lt=({children:t,scale:o=2,closeButton:h=!0})=>{const[u,i]=Y(!1),[f,d]=Y("pdp-zoom"),[v,l]=Y(!1),[X,c]=Y({x:0,y:0}),[m,T]=Y({x:0,y:0}),[M,U]=Y({x:0,y:0}),te=e=>{!u||e.type!=="touchstart"||(c({x:e.touches[0].clientX,y:e.touches[0].clientY}),T({x:M.x,y:M.y}),l(!0))},b=e=>{var ce;if(!v||e.type!=="touchmove")return;const I=(ce=e.currentTarget)==null?void 0:ce.getBoundingClientRect(),g=(100-100/o)/2,z=e.touches[0].clientX-X.x,D=e.touches[0].clientY-X.y,ee=z*100/(I.width*o),k=D*100/(I.height*o),ne=m.x+ee,ae=m.y+k;U({x:Math.max(-g,Math.min(ne,g))||0,y:Math.max(-g,Math.min(ae,g))||0}),e.preventDefault()},P=e=>{var k;const I=(k=e.currentTarget)==null?void 0:k.getBoundingClientRect(),g=(100-100/o)/2;let z;if("touches"in e)z=e.touches[0];else if(e instanceof MouseEvent)z=e;else return;const D=g-(z.clientX-I.left)/I.width*100,ee=g-(z.clientY-I.top)/I.height*100;U({x:Math.max(-g,Math.min(D,g))||0,y:Math.max(-g,Math.min(ee,g))||0})},n=e=>{if(!v){if(u){if(h&&"touches"in e){te(e);return}h||i(!1)}else i(!0),P(e);e.preventDefault()}},y=e=>{if(h&&"touches"in e){b(e);return}u&&P(e)},x=()=>{if(h){l(!1);return}i(!1)},E=e=>{i(!1),e.stopPropagation()},S=u?`scale(${o}) translateX(${M.x}%) translateY(${M.y}%)`:"none",A=K("PDP.Zoom.Close.label").label,he=Ge(de.only(t),{draggable:!1,style:{"--transform":S}});return J(()=>{d(u?`pdp-zoom ${h?"pdp-zoom--no-effects":"pdp-zoom--zoomed"}`:"pdp-zoom")},[u,h]),j("figure",{className:f,onClick:n,onMouseMove:y,onMouseLeave:x,onTouchStart:n,onTouchMove:y,onTouchEnd:x,children:[he,h&&u&&r(ve,{"aria-label":A,variant:"tertiary",className:"pdp-zoom__close-button",icon:r(Ve,{}),onClick:E})]})};function at(t,o="en_US"){if(!ze(t))throw Error("Invalid date string");return t.split(" ")[1]||(t=`${t} 00:00:00`),new Date(t).toLocaleDateString(ke(o)).toString()}function ze(t){if(![/^\d{4}-\d{2}-\d{2}$/,/^\d{1,2}\/\d{1,2}\/\d{4}$/,/^\d{2}\/\d{2}\/\d{4}$/,/^\d{4}\/\d{2}\/\d{2}$/,/^\d{1,2}\.\d{1,2}\.\d{4}$/,/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}$/].some(u=>u.test(t)))return!1;const h=new Date(t);return!isNaN(h.getTime())}function ct(t){const o=new URLSearchParams(window.location.search);Object.entries(t).forEach(([u,i])=>{i===null?o.delete(u):o.set(u,String(i))});let h=window.location.pathname;h+=`?${o.toString()}`,h+=window.location.hash,window.history.replaceState({},"",h)}function ot(){const t=new URLSearchParams(window.location.search),o={};return t.forEach((h,u)=>{o[u]=h}),o}function it(t){var o,h,u,i,f,d,v,l,X,c,m,T;return{productId:Number(t==null?void 0:t.externalId),name:t==null?void 0:t.name,sku:(t==null?void 0:t.variantSku)||(t==null?void 0:t.sku),topLevelSku:t==null?void 0:t.sku,specialToDate:void 0,specialFromDate:void 0,newToDate:void 0,newFromDate:void 0,createdAt:void 0,updatedAt:void 0,manufacturer:void 0,countryOfManufacture:void 0,categories:void 0,productType:void 0,pricing:{regularPrice:((h=(o=t==null?void 0:t.prices)==null?void 0:o.regular)==null?void 0:h.amount)||0,minimalPrice:(i=(u=t==null?void 0:t.prices)==null?void 0:u.final)==null?void 0:i.minimumAmount,maximalPrice:(d=(f=t==null?void 0:t.prices)==null?void 0:f.final)==null?void 0:d.maximumAmount,specialPrice:(l=(v=t==null?void 0:t.prices)==null?void 0:v.final)==null?void 0:l.amount,tierPricing:void 0,currencyCode:((c=(X=t==null?void 0:t.prices)==null?void 0:X.final)==null?void 0:c.currency)||"USD"},canonicalUrl:t==null?void 0:t.url,mainImageUrl:(T=(m=t==null?void 0:t.images)==null?void 0:m[0])==null?void 0:T.url}}const st={PRODUCT_CONTEXT:"productContext"},dt={PRODUCT_PAGE_VIEW:"product-page-view"};function Ue(){return window.adobeDataLayer=window.adobeDataLayer||[],window.adobeDataLayer}function ht(t,o){const h=Ue();h.push({[t]:null}),h.push({[t]:o})}function ut(t,o){Ue().push(u=>{const i=u.getState?u.getState():{};u.push({event:t,eventInfo:{...i,...o}})})}function $e(t){const o=it(t);ht(st.PRODUCT_CONTEXT,o),ut(dt.PRODUCT_PAGE_VIEW)}const pt=({sku:t,hideSku:o,hideQuantity:h,hideShortDescription:u,hideDescription:i,hideAttributes:f,hideURLParams:d,hideSelectedOptionValue:v,slots:l,children:X,initialData:c,carousel:m,optionsConfig:T,useACDL:M,onAddToCart:U,zoomType:te,closeButton:b=!0,...P})=>{var N,Z,H,pe;const n=K("PDP.Product.AddToCart.label").label,y=K("PDP.Product.Incrementer.label").label,x=K("PDP.Product.Details.label").label,[E,S]=Y(Be.getConfig().defaultLocale||"en-US"),[A,he]=Y(),[e=null,I]=Y(c),[g,z]=Y(()=>{const s={sku:t,quantity:1};return e!=null&&e.optionUIDs&&(s.optionsUIDs=e.optionUIDs),s}),[D,ee]=Y(()=>{var s,_;return!(e!=null&&e.options&&((s=e==null?void 0:e.options)==null?void 0:s.length)>0&&((_=e==null?void 0:e.optionUIDs)==null?void 0:_.length)!==(e==null?void 0:e.options.length))}),k={data:e,values:g,valid:D};function ne(s){return s==null?void 0:s.some(_=>(_==null?void 0:_.typename)==="ProductViewOptionValueProduct")}J(()=>{const s=Le.on("pdp/setValues",_=>{console.log("PDP/setValues",_),z(w=>({...w,..._}))});return()=>{s==null||s.off()}},[]),J(()=>{const s=Le.on("locale",_=>{_!==E&&(S(_),Re(t).then(I))});return()=>{s==null||s.off()}},[E,t]),J(()=>{M&&c&&Object.keys(c).length>0&&$e(c)},[c]);const ae=le(s=>{z(_=>({..._,...s}))},[]);J(()=>{Le.emit("pdp/values",g)},[JSON.stringify(g)]);const ce=le(s=>{var V,W;let _=Object.keys(s).map($=>s[$].value).filter($=>$!==void 0);!d&&(e!=null&&e.options)&&!ne(e.options)&&ct({optionsUIDs:_.join(",")}),ae({optionsUIDs:_}),ee((_==null?void 0:_.length)===((V=e==null?void 0:e.options)==null?void 0:V.length));const w=(W=e==null?void 0:e.options)==null?void 0:W.some($=>ne([$]));Te(t,_,T==null?void 0:T.anchorOptions,w).then($=>{var se;I($),(se=T==null?void 0:T.anchorOptions)!=null&&se.length&&_e($,_),M&&($==null?void 0:$.variantSku)!==t&&$e($)})},[t]),_e=le((s,_)=>{var W;const w=(s==null?void 0:s.optionUIDs)??[];_.every($=>w.includes($))||(he(s==null?void 0:s.options),ae({optionsUIDs:w}),ee((w==null?void 0:w.length)===((W=s==null?void 0:s.options)==null?void 0:W.length)))},[t]),ue=le(s=>{Object.keys(s).length!==0&&ee(!1)},[]),B=Se(()=>{var s;return(s=e==null?void 0:e.attributes)==null?void 0:s.map(({label:_,value:w},V)=>{const W=ze(w)?at(w,E):w.toString();return j("li",{children:[_,": ",r("span",{dangerouslySetInnerHTML:{__html:W}})]},V)})},[e==null?void 0:e.attributes,E]),re=!h&&(e!=null&&e.inStock)?r(Q,{name:"Quantity",slot:l==null?void 0:l.Quantity,context:{...k},children:r(Fe,{name:"quantity",defaultValue:g.quantity.toString(),value:g.quantity.toString(),min:1,"aria-label":y,className:"pdp-product__quantity",onValue:s=>{ae({quantity:Number(s)})}},"quantity")}):void 0,ie=()=>{if(e!=null&&e.options)return r(Q,{name:"Options",slot:l==null?void 0:l.Options,context:{...k},children:r(rt,{selectedUIDs:g.optionsUIDs,options:e.options,defaultOptions:g.optionsUIDs,selectionsToUpdate:A,hideSelectedValue:v,onValues:ce,onErrors:ue})})};return r("div",{...P,children:r(Qe,{title:r(Q,{name:"Title",slot:l==null?void 0:l.Title,context:{...k},children:e==null?void 0:e.name}),sku:o?void 0:r(Q,{name:"SKU",slot:l==null?void 0:l.SKU,context:{...k},children:e==null?void 0:e.sku}),options:ie(),breadcrumbs:(l==null?void 0:l.Breadcrumbs)&&r(Q,{name:"Breadcrumbs",slot:l==null?void 0:l.Breadcrumbs,context:{...k,setSeparator(s){this._registerMethod((..._)=>{const w=s(..._),V=w&&r(we,{source:w});this._setProps(W=>({...W,separator:V,children:[r(De,{separator:V,categories:W.categories})]}))})},appendLink(s){this._registerMethod((..._)=>{const{text:w,...V}=s(..._),W=r("a",{...V,children:w});this._setProps($=>{const se=[...$.categories||[],W];return{...$,categories:se,children:[r(De,{separator:$.separator,categories:se})]}})})},appendHTMLElement(s){this._registerMethod((..._)=>{const w=s(..._),V=this._htmlElementToVNode(w);this._setProps(W=>{const $=[...W.categories||[],V];return{...W,categories:$,children:[r(De,{separator:W.separator,categories:$})]}})})}}}),quantity:re,actions:r(Q,{name:"Actions",slot:l==null?void 0:l.Actions,context:{...k,appendButton(s){this._registerMethod((..._)=>{const w=s(..._);if(!w)return;const{text:V,icon:W,...$}=w,se=r(ve,{type:"button",...$,icon:W&&r(we,{source:W}),children:V});this._setProps(a=>({children:[...a.children||[],se]}))})}},children:!(l!=null&&l.Actions)&&r(ve,{size:"medium",type:"submit",icon:r(we,{source:"Cart"}),disabled:!(e!=null&&e.inStock)||!D,"aria-label":n,onClick:()=>U==null?void 0:U(g),children:n})}),shortDescription:u?void 0:r(Q,{name:"ShortDescription",slot:l==null?void 0:l.ShortDescription,context:{...k},children:r("div",{dangerouslySetInnerHTML:{__html:(e==null?void 0:e.shortDescription)??""}})}),description:i?void 0:r(Q,{name:"Description",slot:l==null?void 0:l.Description,context:{...k},children:r("div",{dangerouslySetInnerHTML:{__html:(e==null?void 0:e.description)??""}})}),images:((N=e==null?void 0:e.images)==null?void 0:N.map(({label:s,url:_})=>{var w,V;return r(Oe,{title:s,alt:s,src:_,width:((w=m==null?void 0:m.imageParams)==null?void 0:w.width)??960,height:((V=m==null?void 0:m.imageParams)==null?void 0:V.height)??1191,params:(m==null?void 0:m.imageParams)??{width:960}},_)}))??[],specialPrice:(Z=e==null?void 0:e.prices)!=null&&Z.visible?r(Q,{name:"SpecialPrice",slot:l==null?void 0:l.SpecialPrice,context:{...k},children:r(Ie,{...e.prices.final,locale:ke(E)})}):void 0,price:(H=e==null?void 0:e.prices)!=null&&H.visible&&e.prices.regular&&e.prices.final.amount!==(e==null?void 0:e.prices.regular.amount)?r(Q,{name:"RegularPrice",slot:l==null?void 0:l.RegularPrice,context:{...k},children:r(Ie,{...e.prices.regular,locale:ke(E)})}):void 0,zoomType:te,closeButton:b,carouselConfig:{...m,thumbnails:m&&Object.keys(m).length?((pe=e==null?void 0:e.images)==null?void 0:pe.map(({label:s,url:_})=>{var w,V;return r(Oe,{title:s,alt:s,src:_,width:((w=m==null?void 0:m.thumbnailParams)==null?void 0:w.width)??200,height:((V=m==null?void 0:m.thumbnailParams)==null?void 0:V.height)??248,params:(m==null?void 0:m.thumbnailParams)??{width:200}},_)}))??[]:[]},outOfStock:!(e!=null&&e.inStock),attributes:f?void 0:r(Q,{name:"Attributes",slot:l==null?void 0:l.Attributes,context:{...k},children:B!=null&&B.length?j(ye,{children:[x,r("ul",{children:B})]}):null}),galleryContent:(l==null?void 0:l.GalleryContent)&&r(Q,{name:"GalleryContent",slot:l.GalleryContent,context:{...k}}),infoContent:(l==null?void 0:l.InfoContent)&&r(Q,{name:"InfoContent",slot:l.InfoContent,context:{...k}}),productContent:(l==null?void 0:l.Content)&&r(Q,{name:"Content",slot:l.Content,context:{...k}})})})};pt.getInitialData=async function({sku:t,optionsConfig:o}){var v,l,X,c,m,T,M;function h(U){return U.some(te=>te.__typename==="ProductViewOptionValueProduct")}let u;const i=Be.getConfig(),f=((v=ot().optionsUIDs)==null?void 0:v.split(","))||((c=(X=(l=i==null?void 0:i.models)==null?void 0:l.ProductDetails)==null?void 0:X.initialData)==null?void 0:c.optionsUIDs),d=(T=(m=i==null?void 0:i.models)==null?void 0:m.ProductDetails)==null?void 0:T.initialData;return d&&Object.keys(d).length>0&&(u=(M=d.options)==null?void 0:M.some(U=>h(U==null?void 0:U.values))),f!=null&&f.length?await Te(t,f,o==null?void 0:o.anchorOptions,u):await Re(t)};export{pt as ProductDetails,pt as default};
