import*as me from"@dropins/tools/preact-compat.js";import{useState as X,Children as de,useRef as Ne,useMemo as we,useEffect as Z,useCallback as ne}from"@dropins/tools/preact-compat.js";import{debounce as xe,classes as $,VComponent as j,toLanguageTag as De,Slot as K}from"@dropins/tools/lib.js";import{Button as _e,Icon as fe,Price as ge,Picker as He,ColorSwatch as Ve,ImageSwatch as qe,TextSwatch as je,Incrementer as Xe,Breadcrumbs as Fe,Image as ke}from"@dropins/tools/components.js";import{jsxs as V,jsx as r,Fragment as Pe}from"@dropins/tools/preact-jsx-runtime.js";import{useText as F}from"@dropins/tools/i18n.js";import{cloneElement as Ge}from"@dropins/tools/preact.js";import{c as $e,d as Re}from"../chunks/getRefinedProduct.js";import{events as Le}from"@dropins/tools/event-bus.js";import{c as Te}from"../chunks/initialize.js";import"@dropins/tools/fetch-graphql.js";const Ye=e=>me.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},me.createElement("path",{d:"M7.74512 9.87701L12.0001 14.132L16.2551 9.87701",stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"square",strokeLinejoin:"round"})),Be=e=>me.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},me.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M18.3599 5.64001L5.62988 18.37",stroke:"currentColor"}),me.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M18.3599 18.37L5.62988 5.64001",stroke:"currentColor"})),Ke=24,Me=16,be=2,Ze="32";var We=(e=>(e[e.small=16]="small",e[e.medium=24]="medium",e[e.large=64]="large",e))(We||{});const ve=({show:e=1,scrollbar:o=!1,peak:d=!1,arrows:p=!1,controls:s="dots",arrowsOnMainImage:f=!1,loop:h=!1,gap:b=null,direction:l="horizontal",width:G="100%",height:c="100%",defaultIndex:m=0,className:B,children:R,thumbnails:Q=null,isZoomed:oe,...v})=>{const P=F("PDP.Carousel.label").label,n=F("PDP.Carousel.Slide.label").label,S=F("PDP.Carousel.Previous.label").label,E=F("PDP.Carousel.Next.label").label,I=F("PDP.Carousel.Controls.label").label,y=F("PDP.Carousel.Controls.Button.label").label,[x,he]=X(()=>Ee(e)),t=Math.ceil(de.count(R)/x),O=d?Ke:0,g=b?We[b]:0,T=de.count(R)%x,[L,C]=X(h?m+1:m),k=Ne([]),[ee,se]=X(0),[re,ue]=X(0),le=we(()=>de.toArray(Q),[Q]),W=we(()=>{const a=de.toArray(R).reduce((u,D,M)=>M%x===0?[...u,[D]]:[...u.slice(0,-1),[...u[u.length-1],D]],[]);return!h||a.length===1?a:h&&de.count(R)%x===0?[a[t-1]].concat(a).concat([a[0],a[1]]):[de.toArray(R).slice(-x)].concat(a).concat([a[0],a[1]])},[R,x,t,h]),te=Ne(null),ae=Ne(null),N=s==="thumbnailsRow"||s==="thumbnailsColumn";Z(()=>{const a=document.body,u=xe(()=>{var H,ce;se(((H=te.current)==null?void 0:H.offsetWidth)??0),ue(((ce=te.current)==null?void 0:ce.offsetHeight)??0);const M=window.innerWidth,q=Ee(e,M);q!==x&&he(q)},50),D=new ResizeObserver(u);return D.observe(a),()=>{D.unobserve(a)}},[x,e]);const Y=ne(a=>{const u=h?a-1:a,D=k==null?void 0:k.current[0],M=(D==null?void 0:D.offsetWidth)+Me,q=(D==null?void 0:D.offsetHeight)+Me,H=ae.current,ce=s==="thumbnailsRow",Ae=s==="thumbnailsColumn",pe=ce?H==null?void 0:H.offsetWidth:H==null?void 0:H.offsetHeight,J=ce?M:q;(ce||Ae)&&pe&&(J*(u+1)>pe&&(H.style.scrollBehavior="smooth",ce?H.scrollLeft=(u+be)*J:H.scrollTop=(u+be)*J),(ce?H.scrollLeft:H.scrollTop)>J*u&&(H.style.scrollBehavior="smooth",ce?H.scrollLeft=(u-be)*J:H.scrollTop=(u-be)*J))},[s,h]);Z(()=>{Y(L)},[L,Y]);const U=ne((a,u,D)=>{N&&Y(a);const M=te.current,q=O?M.offsetWidth-O:M.offsetWidth-O+g;if(!Array.from(M.querySelectorAll("[data-index]")).filter(pe=>{const J=Number(pe.getAttribute("data-index"));return!isNaN(J)&&J>-1})[a])return;if(D){const pe=a===0?t:0,J=q*(t+(T||x)/x);if(M.scrollLeft>=0&&M.scrollLeft<q-5){U(1,!0);return}if(M.scrollLeft>J-q&&M.scrollLeft<=J){U(t,!0);return}M.style.scrollBehavior="auto",M.scrollLeft=pe===0?0:J,U(pe===0?1:t,!0);return}const Ae=(M.offsetWidth-g)/x*W[a].length-O;M.style.scrollBehavior=u?"smooth":"auto",M.scrollLeft=W[a].length===x?q*a:q*(a-1)+Ae},[g,t,O,x,T,W,Y,s]),i=ne(()=>{if(h){const u=L-1;U(u,!0,L===1);return}const a=L<=0?0:L-1;U(a,!0)},[L,U,h]),_=ne(()=>{const a=W.length-1;if(h){const D=L+1;U(D,!0,L===t);return}const u=L>=a?a:L+1;U(u,!0)},[W.length,h,L,U,t]);Z(()=>{const a=u=>{u.key==="ArrowLeft"&&(u.preventDefault(),i()),u.key==="ArrowRight"&&(u.preventDefault(),_())};return window.addEventListener("keydown",a),()=>{window.removeEventListener("keydown",a)}},[_,i]),Z(()=>{U(h?m+1:m,!1)},[m,U,h]);const w=xe(()=>{const a=te.current,u=O?a.offsetWidth-O:a.offsetWidth-O+g,D=a.scrollLeft/u,M=Math.round(D)-D<1?Math.round(D):Math.ceil(D);if(N&&Y(M),h){const q=u*(t+(T||x)/x);if(Math.ceil(a.scrollLeft)>=Math.ceil(q)-5){a.style.scrollBehavior="auto",a.scrollLeft=a.offsetWidth*1+(Math.ceil(a.scrollLeft)-Math.ceil(q)-O);return}if(a.scrollLeft===0){a.style.scrollBehavior="auto",a.scrollLeft=q-a.offsetWidth+O;return}}L!==M&&C(M)},100);Z(()=>{const a=te.current;return a==null||a.addEventListener("scroll",w),()=>{a==null||a.removeEventListener("scroll",w)}},[w]);const A=(a,u,D)=>r(_e,{className:$([["pdp-carousel__button",!a],[`pdp-carousel__button--${u}`,!a],[`pdp-carousel__button--${s}`,a]]),style:{"--height":`${re}px`},variant:"tertiary","aria-label":u==="next"?E:S,onClick:D,disabled:h?!1:u==="next"?L>=W.length-1:L<1,children:r(fe,{className:$([["pdp-carousel__button__icon",!a],[`pdp-carousel__button__icon--${u}`,!a],[`pdp-carousel__button__icon--${s}--${u}`,a]]),size:Ze,source:Ye})}),z=p&&W.length!=1&&A(N,"prev",i),ie=p&&W.length!=1&&A(N,"next",_),ye=p&&W.length!=1&&A(!1,"prev",i),Se=p&&W.length!=1&&A(!1,"next",_);return V("div",{role:"region","aria-roledescription":P,className:$(["pdp-carousel",["pdp-carousel--main-image-controls",f],["pdp-carousel--arrows",p&&!N],[`pdp-carousel--${s}`,N],B]),style:{"--flex-carousel":s==="thumbnailsColumn"?"row-reverse":"column","--gap":N?"0":"var(--spacing-small)","--width":G},...v,children:[r("div",{ref:te,className:$(["pdp-carousel__wrapper",`pdp-carousel__wrapper--${l}`,["pdp-carousel__wrapper--scrollbar",o],["pdp-carousel__wrapper--peak",d]]),style:{"--total-width":s==="thumbnailsColumn"?"81.6%":"100%","--height":s==="thumbnailsColumn"?"auto":c,"--gap":b?`var(--spacing-${b})`:"0px","--per-page":x},tabIndex:0,children:W.map((a,u)=>{const D=a.length<x;return r("div",{role:"group","aria-roledescription":n,"data-index":u,className:$(["pdp-carousel__slide",`pdp-carousel__slide--${l}`,["pdp-carousel__slide--active",L===u],["pdp-carousel__slide--orphan",D]]),style:{"--length":a.length},children:a},u)})}),!N&&V(Pe,{children:[z,ie]}),N&&f&&V(Pe,{children:[ye,Se]}),s&&W.length!=1&&V("div",{className:$([[`pdp-carousel__controls__container--${s}`,N],["pdp-carousel__controls__container--no-arrows",!p||f]]),style:{"--width":s==="thumbnailsRow"?`${ee}px`:G,"--height":`${re}px`,"--nr-thumbnails":le.length},children:[(N||oe)&&!f&&z,r("div",{ref:ae,className:$([[`pdp-carousel__controls__wrapper--${s}`,N],["pdp-carousel__controls__wrapper",N]]),children:r("div",{role:"group","aria-label":I,className:$(["pdp-carousel__controls",[`pdp-carousel__controls--${s}`,N]]),children:(h?W.slice(0,t):W).map((a,u)=>{const D=h?t:W.length,M=h?L-1===u:L===u;return N?V("label",{className:$(["pdp-carousel__thumbnail__container"]),ref:q=>{q&&(k.current[u]=q)},children:[r("input",{type:"radio",name:"carousel-thumbnails","aria-label":y.replace("{key}",String(u+1)).replace("{total}",String(D)),checked:M&&ee!==0,onChange:()=>{U(h?u+1:u,!0)},...v,className:$(["pdp-carousel__thumbnail",["pdp-carousel__thumbnail--selected",M&&ee!==0]])}),r("span",{className:$(["pdp-carousel__thumbnail__span"]),children:le[u]})]},u):r("button",{"aria-label":y.replace("{key}",String(u+1)).replace("{total}",String(D)),onClick:()=>{U(h?u+1:u,!0)},className:$(["pdp-carousel__controls__button",["pdp-carousel__controls__button--active",M]])},u)})})}),(N||oe)&&!f&&ie]})]})};function Ee(e,o=0){if(typeof e=="number")return e;const{small:d,medium:p,large:s}=e,h=[{breakpoint:1024,value:s},{breakpoint:786,value:p},{breakpoint:0,value:d}].find(({breakpoint:b})=>o>b);return h?h.value:d}const Qe=({title:e,breadcrumbs:o,galleryContent:d,infoContent:p,productContent:s,sku:f,outOfStock:h,shortDescription:b,description:l,attributes:G,images:c,options:m,price:B,specialPrice:R,className:Q,children:oe,quantity:v,actions:P,carouselConfig:n,zoomType:S="overlay",closeButton:E=!0,...I})=>{var C,k,ee,se,re,ue,le,W,te;const y=F("PDP.Product.RegularPrice.label").label,x=F("PDP.Product.SpecialPrice.label").label,he=F("PDP.Product.OutOfStock.label").label,t=F("PDP.Product.Image.label").label,[O,g]=X(null),T=c!=null&&c.length?c.map((ae,N)=>{var U;const Y=(U=e==null?void 0:e.props)!=null&&U.children?t==null?void 0:t.replace("{product}",e.props.children.toString()).replace("{key}",String(N+1)).replace("{total}",String(c.length)):void 0;return S==="zoom"?r(lt,{closeButton:E,children:r(j,{node:ae,loading:N===0?"eager":"lazy",alt:Y},N)}):r(j,{node:ae,loading:N===0?"eager":"lazy",alt:Y,onClick:()=>g(N)},N)}):r("img",{src:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",className:"pdp-product__images__placeholder","aria-hidden":!0}),L=(C=n==null?void 0:n.thumbnails)!=null&&C.length?n.thumbnails.map((ae,N)=>{var Y;return r(j,{node:ae,loading:(n==null?void 0:n.thumbnailsLoadingMode)||"lazy",alt:((Y=e==null?void 0:e.props)==null?void 0:Y.children)&&(t==null?void 0:t.replace("{product}",e.props.children.toString()).replace("{key}",String(N+1)).replace("{total}",String(c.length)))},N)}):r("img",{src:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",className:"pdp-product__images__placeholder","aria-hidden":!0});return V("div",{...I,className:$(["pdp-product",Q]),children:[o&&r(j,{node:o,className:"pdp-product__breadcrumbs"}),V("div",{className:"pdp-product__column-container pdp-product__gallery-column",children:[r("div",{className:"pdp-product__column-body",children:(k=n==null?void 0:n.controls)!=null&&k.desktop?r(ve,{className:"pdp-product__overlay__carousel",arrows:(c==null?void 0:c.length)>1,controls:(c==null?void 0:c.length)>1?n.controls.desktop:"dots",arrowsOnMainImage:n==null?void 0:n.arrowsOnMainImage,loop:(n==null?void 0:n.loopable)&&(c==null?void 0:c.length)>1,peak:((ee=n==null?void 0:n.thumbnails)==null?void 0:ee.length)>1&&((se=n==null?void 0:n.peak)==null?void 0:se.desktop)||!1,gap:(n==null?void 0:n.gap)||null,width:"100%",height:"100%",defaultIndex:O||0,thumbnails:L,children:T}):r(Je,{className:"pdp-product__images",gap:"small",children:T})}),d&&r(j,{node:d,className:"pdp-product__gallery-content"})]}),V("div",{className:"pdp-product__column-container pdp-product__content-column",children:[V("div",{className:"pdp-product__column-body",children:[V("div",{className:"pdp-product__header",children:[e&&r(j,{node:e,className:"pdp-product__title"}),f&&r(j,{node:f,className:"pdp-product__sku"})]}),V("div",{className:"pdp-product__prices",children:[R&&r(j,{node:R,className:$(["pdp-product__price-special","pdp-product__price"]),"aria-label":x,role:"text"}),B&&r(j,{node:B,className:$(["pdp-product__price-regular","pdp-product__price--grey"]),"aria-label":y,role:"text"})]}),(re=n==null?void 0:n.controls)!=null&&re.mobile&&((ue=n==null?void 0:n.controls)==null?void 0:ue.mobile)==="thumbnailsRow"?r(ve,{className:"pdp-product__images pdp-product__images--carousel pdp-product__images--carousel--thumbnails",width:"100%",height:"auto",arrows:(c==null?void 0:c.length)>1,controls:(c==null?void 0:c.length)>1?"thumbnailsRow":null,loop:(n==null?void 0:n.loopable)&&(c==null?void 0:c.length)>1,peak:((le=n==null?void 0:n.thumbnails)==null?void 0:le.length)>1&&((W=n==null?void 0:n.peak)==null?void 0:W.mobile)||!1,gap:(n==null?void 0:n.gap)||null,thumbnails:L,children:T}):r(ve,{className:"pdp-product__images pdp-product__images--carousel",peak:((te=n==null?void 0:n.peak)==null?void 0:te.mobile)&&(c==null?void 0:c.length)>1,gap:(n==null?void 0:n.gap)||null,width:"100%",height:"auto",arrows:(c==null?void 0:c.length)>1,controls:(c==null?void 0:c.length)>1?"dots":null,loop:(n==null?void 0:n.loopable)&&(c==null?void 0:c.length)>1,children:T}),V("div",{className:$(["pdp-product__actions",["pdp-product__actions--out-of-stock",h]]),children:[h&&r("div",{className:"pdp-product__out-of-stock__text",children:he}),m&&r(j,{node:m,className:$(["pdp-product__options"])}),v&&r("div",{className:"pdp-product__quantity",children:r(j,{node:v})}),P&&r(j,{node:P,className:$(["pdp-product__buttons"])})]}),b&&r(j,{node:b,className:$(["pdp-product__short_description"])}),l&&r(j,{node:l,className:$(["pdp-product__description"])}),G?r("div",{className:"pdp-product__attributes",children:G}):null]}),p&&r(j,{node:p,className:"pdp-product__info-content"})]}),s&&r(j,{node:s,className:"pdp-product__content"}),O===null?null:r(Ce,{className:"pdp-product__overlay",onClose:()=>g(null),centered:!0,children:r(ve,{className:"pdp-product__overlay__carousel",arrows:(c==null?void 0:c.length)>1,width:"100%",height:"100%",defaultIndex:O||0,loop:(n==null?void 0:n.loopable)&&(c==null?void 0:c.length)>1,controls:(c==null?void 0:c.length)>1?"dots":null,isZoomed:!0,children:T})})]})},Je=({children:e,gap:o=null,className:d,style:p,...s})=>{const f=de.count(e);return r("div",{...s,className:$(["pdp-gallery-grid",d]),style:{"--gap":o?`var(--spacing-${o})`:"0px",...p},children:de.map(e,(h,b)=>r("div",{className:"pdp-gallery-grid__item",children:r(j,{node:h,loading:b===0?"eager":"lazy"},h.props.src)},f+b))})},Ie=({amount:e,currency:o,locale:d,variant:p,sale:s,minimumAmount:f,maximumAmount:h,className:b,...l})=>r(Pe,{children:e||f===h?r("div",{className:"pdp-price-range",...l,children:r(ge,{amount:e||f,currency:o,locale:d,variant:p,sale:s,className:b})}):V("div",{className:"pdp-price-range",...l,children:[r(ge,{amount:f,currency:o,locale:d,className:b}),r("span",{className:"pdp-price-range__label",children:"-"}),r(ge,{amount:h,currency:o,locale:d,className:b})]})}),Ce=({centered:e,onClose:o,className:d,children:p,...s})=>{const f=F("PDP.Overlay.Close.label").label,h=ne(()=>{o==null||o()},[o]);return Z(()=>{const b=l=>{l.key==="Escape"&&h()};return document.addEventListener("keydown",b),()=>{document.removeEventListener("keydown",b)}},[h]),Z(()=>{const b=document.scrollingElement,l=b.style.overflow;return b.style.overflow="hidden",()=>{b.style.overflow=l}},[]),V("div",{...s,className:$(["pdp-overlay",["pdp-overlay--centered",e],d]),children:[r("div",{className:"pdp-overlay__content",children:p}),r(_e,{"aria-label":f,variant:"tertiary",className:"pdp-overlay__close-button",onClick:h,icon:r(Be,{})})]})},et=["text","image","color","dropdown"],tt=e=>e.map(o=>({...o,text:o.label,disabled:!o.inStock}));function nt(e,o){return e.reduce((d,p)=>{const s=o==null?void 0:o.find(h=>h.items.find(b=>b.id===p));if(!s)return d;const f=s.items.find(h=>h.id===p);return{...d,[s.id]:{label:f.label,value:f.id}}},{})}const rt=({options:e,hideSelectedValue:o,selectedUIDs:d,onValues:p,onErrors:s,defaultOptions:f,selectionsToUpdate:h,className:b,children:l,...G})=>{const c=F("PDP.Swatches.Required.label").label,[m,B]=X(()=>e==null?void 0:e.reduce((P,n)=>{const{items:S}=n,E=S==null?void 0:S.find(y=>f==null?void 0:f.includes(y.id)),I=S==null?void 0:S.find(y=>y.selected);return E?{...P,[n.id]:{label:E.label,value:E.id}}:I?{...P,[n.id]:{label:I.label,value:I.id}}:P},{}));Z(()=>{if(d){const v=nt(d,e);if(JSON.stringify(v)===JSON.stringify(m))return;R(Object.keys(v)[0],v[Object.keys(v)[0]].label,d[0])}},[d]),Z(()=>{h==null||h.forEach(v=>{B(P=>{var E;const n=(E=v==null?void 0:v.items)==null?void 0:E.find(I=>I.selected);return n?{...P,[v.id]:{label:n==null?void 0:n.label,value:n==null?void 0:n.id}}:P})})},[h,B]),we(()=>{const v=e==null?void 0:e.reduce((P,n)=>{var S;return(S=n==null?void 0:n.items)==null||S.forEach(E=>{var y;const I=((y=m[n.id])==null?void 0:y.value)===E.id;n.required&&!I&&(P[n.id]=c)}),P},{});return s==null||s(v),v},[m]);const R=ne((v,P,n)=>{B(S=>{const E={...S,[v]:{label:P,value:n}};return p==null||p(E,n),E})},[p]),Q=(v,P)=>{var S;const n=((S=P.selectedOptions[0])==null?void 0:S.label)??"";R(v,n,P.value)},oe=ne(({items:v,id:P,required:n,type:S,selected:E,label:I})=>r("div",{className:$(["pdp-swatches__options"]),children:(S==null?void 0:S.toLowerCase())==="dropdown"?r(He,{"aria-label":I,handleSelect:y=>Q(P,y.target),options:tt(v),value:E}):v==null?void 0:v.map(y=>{const x={key:y.id,id:y.id,name:P,value:y.value,label:y.label,groupAriaLabel:I,selected:E===y.id,outOfStock:!y.inStock,required:n===null?!0:n,onValue:()=>{R(P,y.label,y.id)}};switch(S){case"text":return r(je,{...x,label:y.label});case"image":return r(qe,{...x,src:y.value,alt:y.label});case"color":return r(Ve,{...x,size:"large",color:y.value});default:return console.warn(`Invalid swatch type ${S}`),null}})}),[R]);return r("div",{...G,className:$(["pdp-swatches",b]),children:e==null?void 0:e.map(({type:v,label:P,id:n,multiple:S,required:E,items:I})=>{var y;if(!v){console.warn("Bundle product not supported on UI.");return}return et.includes(v)||console.warn(`Invalid swatch type ${v}`),S&&console.warn("Multiple selection swatches are not currently supported."),V("div",{id:`swatch-item-${n}`,"data-slot-key":`product-swatch--${n}`,className:"pdp-swatches__field",children:[r("div",{className:"pdp-swatches__field__label",children:m[n]?o?`${P}`:`${P}: ${m[n].label}`:P}),r(oe,{id:n,type:v,required:E,items:I,label:P,selected:(y=m[n])==null?void 0:y.value})]},`swatch-item-${n}`)})})},lt=({children:e,scale:o=2,closeButton:d=!0})=>{const[p,s]=X(!1),[f,h]=X("pdp-zoom"),[b,l]=X(!1),[G,c]=X({x:0,y:0}),[m,B]=X({x:0,y:0}),[R,Q]=X({x:0,y:0}),oe=t=>{!p||t.type!=="touchstart"||(c({x:t.touches[0].clientX,y:t.touches[0].clientY}),B({x:R.x,y:R.y}),l(!0))},v=t=>{var re;if(!b||t.type!=="touchmove")return;const O=(re=t.currentTarget)==null?void 0:re.getBoundingClientRect(),g=(100-100/o)/2,T=t.touches[0].clientX-G.x,L=t.touches[0].clientY-G.y,C=T*100/(O.width*o),k=L*100/(O.height*o),ee=m.x+C,se=m.y+k;Q({x:Math.max(-g,Math.min(ee,g))||0,y:Math.max(-g,Math.min(se,g))||0}),t.preventDefault()},P=t=>{var k;const O=(k=t.currentTarget)==null?void 0:k.getBoundingClientRect(),g=(100-100/o)/2;let T;if("touches"in t)T=t.touches[0];else if(t instanceof MouseEvent)T=t;else return;const L=g-(T.clientX-O.left)/O.width*100,C=g-(T.clientY-O.top)/O.height*100;Q({x:Math.max(-g,Math.min(L,g))||0,y:Math.max(-g,Math.min(C,g))||0})},n=t=>{if(!b){if(p){if(d&&"touches"in t){oe(t);return}s(!1)}else s(!0),P(t);t.preventDefault()}},S=t=>{if(d&&"touches"in t){v(t);return}p&&P(t)},E=()=>{if(d){l(!1);return}s(!1)},I=t=>{s(!1),t.stopPropagation()},y=p?`scale(${o}) translateX(${R.x}%) translateY(${R.y}%)`:"none",x=F("PDP.Zoom.Close.label").label,he=Ge(de.only(e),{draggable:!1,style:{"--transform":y}});return Z(()=>{h(p?`pdp-zoom ${d?"pdp-zoom--no-effects":"pdp-zoom--zoomed"}`:"pdp-zoom")},[p,d]),V("figure",{className:f,onClick:n,onMouseMove:S,onMouseLeave:E,onTouchStart:n,onTouchMove:S,onTouchEnd:E,children:[he,d&&p&&r(_e,{"aria-label":x,variant:"tertiary",className:"pdp-zoom__close-button",icon:r(Be,{}),onClick:I})]})};function at(e,o="en_US"){if(!ze(e))throw Error("Invalid date string");return e.split(" ")[1]||(e=`${e} 00:00:00`),new Date(e).toLocaleDateString(De(o)).toString()}function ze(e){if(![/^\d{4}-\d{2}-\d{2}$/,/^\d{1,2}\/\d{1,2}\/\d{4}$/,/^\d{2}\/\d{2}\/\d{4}$/,/^\d{4}\/\d{2}\/\d{2}$/,/^\d{1,2}\.\d{1,2}\.\d{4}$/,/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}$/].some(p=>p.test(e)))return!1;const d=new Date(e);return!isNaN(d.getTime())}function ct(e){const o=new URLSearchParams(window.location.search);Object.entries(e).forEach(([p,s])=>{s===null?o.delete(p):o.set(p,String(s))});let d=window.location.pathname;d+=`?${o.toString()}`,d+=window.location.hash,window.history.replaceState({},"",d)}function ot(){const e=new URLSearchParams(window.location.search),o={};return e.forEach((d,p)=>{o[p]=d}),o}function it(e){var o,d,p,s,f,h,b,l,G,c,m,B;return{productId:Number(e==null?void 0:e.externalId),name:e==null?void 0:e.name,sku:e==null?void 0:e.sku,topLevelSku:e==null?void 0:e.externalParentId,specialToDate:void 0,specialFromDate:void 0,newToDate:void 0,newFromDate:void 0,createdAt:void 0,updatedAt:void 0,manufacturer:void 0,countryOfManufacture:void 0,categories:void 0,productType:void 0,pricing:{regularPrice:((d=(o=e==null?void 0:e.prices)==null?void 0:o.regular)==null?void 0:d.amount)||0,minimalPrice:(s=(p=e==null?void 0:e.prices)==null?void 0:p.final)==null?void 0:s.minimumAmount,maximalPrice:(h=(f=e==null?void 0:e.prices)==null?void 0:f.final)==null?void 0:h.maximumAmount,specialPrice:(l=(b=e==null?void 0:e.prices)==null?void 0:b.final)==null?void 0:l.amount,tierPricing:void 0,currencyCode:((c=(G=e==null?void 0:e.prices)==null?void 0:G.final)==null?void 0:c.currency)||"USD"},canonicalUrl:e==null?void 0:e.url,mainImageUrl:(B=(m=e==null?void 0:e.images)==null?void 0:m[0])==null?void 0:B.url}}const dt={PRODUCT_CONTEXT:"productContext"},st={PRODUCT_PAGE_VIEW:"product-page-view"};function Ue(){return window.adobeDataLayer=window.adobeDataLayer||[],window.adobeDataLayer}function ht(e,o){const d=Ue();d.push({[e]:null}),d.push({[e]:o})}function pt(e,o){Ue().push(p=>{const s=p.getState?p.getState():{};p.push({event:e,eventInfo:{...s,...o}})})}function Oe(e){const o=it(e);ht(dt.PRODUCT_CONTEXT,o),pt(st.PRODUCT_PAGE_VIEW)}const ut=({sku:e,hideSku:o,hideQuantity:d,hideShortDescription:p,hideDescription:s,hideAttributes:f,hideURLParams:h,hideSelectedOptionValue:b,slots:l,children:G,initialData:c,carousel:m,optionsConfig:B,useACDL:R,onAddToCart:Q,zoomType:oe,closeButton:v=!0,...P})=>{var ae,N,Y,U;const n=F("PDP.Product.AddToCart.label").label,S=F("PDP.Product.Incrementer.label").label,E=F("PDP.Product.Details.label").label,[I,y]=X(Te.getConfig().defaultLocale||"en-US"),[x,he]=X(),[t=null,O]=X(c),[g,T]=X(()=>{const i={sku:e,quantity:1};return t!=null&&t.optionUIDs&&(i.optionsUIDs=t.optionUIDs),i}),[L,C]=X(()=>{var i,_;return!(t!=null&&t.options&&((i=t==null?void 0:t.options)==null?void 0:i.length)>0&&((_=t==null?void 0:t.optionUIDs)==null?void 0:_.length)!==(t==null?void 0:t.options.length))}),k={data:t,values:g,valid:L};Z(()=>{const i=Le.on("pdp/setValues",_=>{T(w=>({...w,..._}))});return()=>{i==null||i.off()}},[]),Z(()=>{const i=Le.on("locale",_=>{_!==I&&(y(_),$e(e).then(O))});return()=>{i==null||i.off()}},[I,e]),Z(()=>{R&&c&&Object.keys(c).length>0&&Oe(c)},[c]);const ee=ne(i=>{T(_=>({..._,...i}))},[]);Z(()=>{Le.emit("pdp/values",g)},[JSON.stringify(g)]);const se=ne(i=>{var w;let _=Object.keys(i).map(A=>i[A].value).filter(A=>A!==void 0);h||ct({optionsUIDs:_.join(",")}),ee({optionsUIDs:_}),C((_==null?void 0:_.length)===((w=t==null?void 0:t.options)==null?void 0:w.length)),Re(e,_,B==null?void 0:B.anchorOptions).then(A=>{var z;O(A),(z=B==null?void 0:B.anchorOptions)!=null&&z.length&&re(A,_),R&&(A==null?void 0:A.sku)!==e&&Oe(A)})},[e]),re=ne((i,_)=>{var z;const w=(i==null?void 0:i.optionUIDs)??[];_.every(ie=>w.includes(ie))||(he(i==null?void 0:i.options),ee({optionsUIDs:w}),C((w==null?void 0:w.length)===((z=i==null?void 0:i.options)==null?void 0:z.length)))},[e]),ue=ne(i=>{Object.keys(i).length!==0&&C(!1)},[]),le=we(()=>{var i;return(i=t==null?void 0:t.attributes)==null?void 0:i.map(({label:_,value:w},A)=>{const z=ze(w)?at(w,I):w.toString();return V("li",{children:[_,": ",r("span",{dangerouslySetInnerHTML:{__html:z}})]},A)})},[t==null?void 0:t.attributes,I]),W=!d&&(t!=null&&t.inStock)?r(K,{name:"Quantity",slot:l==null?void 0:l.Quantity,context:{...k},children:r(Xe,{name:"quantity",defaultValue:g.quantity.toString(),value:g.quantity.toString(),min:1,"aria-label":S,className:"pdp-product__quantity",onValue:i=>{ee({quantity:Number(i)})}},"quantity")}):void 0,te=()=>{if(t!=null&&t.options)return r(K,{name:"Options",slot:l==null?void 0:l.Options,context:{...k},children:r(rt,{selectedUIDs:g.optionsUIDs,options:t.options,defaultOptions:g.optionsUIDs,selectionsToUpdate:x,hideSelectedValue:b,onValues:se,onErrors:ue})})};return r("div",{...P,children:r(Qe,{title:r(K,{name:"Title",slot:l==null?void 0:l.Title,context:{...k},children:t==null?void 0:t.name}),sku:o?void 0:r(K,{name:"SKU",slot:l==null?void 0:l.SKU,context:{...k},children:t==null?void 0:t.sku}),options:te(),breadcrumbs:(l==null?void 0:l.Breadcrumbs)&&r(K,{name:"Breadcrumbs",slot:l==null?void 0:l.Breadcrumbs,context:{...k,setSeparator(i){this._registerMethod((..._)=>{const w=i(..._),A=w&&r(fe,{source:w});this._setProps(z=>({...z,separator:A}))})},appendLink(i){this._registerMethod((..._)=>{const{text:w,...A}=i(..._),z=r("a",{...A,children:w});this._setProps(ie=>({...ie,categories:[...ie.categories||[],z]}))})},appendHTMLElement(i){this._registerMethod((..._)=>{const w=i(..._),A=this._htmlElementToVNode(w);this._setProps(z=>({...z,categories:[...z.categories||[],A]}))})}},render:({separator:i,categories:_})=>r(Fe,{separator:i,categories:_})}),quantity:W,actions:r(K,{name:"Actions",slot:l==null?void 0:l.Actions,context:{...k,appendButton(i){this._registerMethod((..._)=>{const w=i(..._);if(!w)return;const{text:A,icon:z,...ie}=w,ye=r(_e,{type:"button",...ie,icon:z&&r(fe,{source:z}),children:A});this._setProps(Se=>({children:[...Se.children||[],ye]}))})}},children:!(l!=null&&l.Actions)&&r(_e,{size:"medium",type:"submit",icon:r(fe,{source:"Cart"}),disabled:!(t!=null&&t.inStock)||!L,"aria-label":n,onClick:()=>Q==null?void 0:Q(g),children:n})}),shortDescription:p?void 0:r(K,{name:"ShortDescription",slot:l==null?void 0:l.ShortDescription,context:{...k},children:r("div",{dangerouslySetInnerHTML:{__html:(t==null?void 0:t.shortDescription)??""}})}),description:s?void 0:r(K,{name:"Description",slot:l==null?void 0:l.Description,context:{...k},children:r("div",{dangerouslySetInnerHTML:{__html:(t==null?void 0:t.description)??""}})}),images:((ae=t==null?void 0:t.images)==null?void 0:ae.map(({label:i,url:_})=>{var w,A;return r(ke,{title:i,alt:i,src:_,width:((w=m==null?void 0:m.imageParams)==null?void 0:w.width)??960,height:((A=m==null?void 0:m.imageParams)==null?void 0:A.height)??1191,params:(m==null?void 0:m.imageParams)??{width:960}},_)}))??[],specialPrice:(N=t==null?void 0:t.prices)!=null&&N.visible?r(K,{name:"SpecialPrice",slot:l==null?void 0:l.SpecialPrice,context:{...k},children:r(Ie,{...t.prices.final,locale:De(I)})}):void 0,price:(Y=t==null?void 0:t.prices)!=null&&Y.visible&&t.prices.regular&&t.prices.final.amount!==(t==null?void 0:t.prices.regular.amount)?r(K,{name:"RegularPrice",slot:l==null?void 0:l.RegularPrice,context:{...k},children:r(Ie,{...t.prices.regular,locale:De(I)})}):void 0,zoomType:oe,closeButton:v,carouselConfig:{...m,thumbnails:m&&Object.keys(m).length?((U=t==null?void 0:t.images)==null?void 0:U.map(({label:i,url:_})=>{var w,A;return r(ke,{title:i,alt:i,src:_,width:((w=m==null?void 0:m.thumbnailParams)==null?void 0:w.width)??200,height:((A=m==null?void 0:m.thumbnailParams)==null?void 0:A.height)??248,params:(m==null?void 0:m.thumbnailParams)??{width:200}},_)}))??[]:[]},outOfStock:!(t!=null&&t.inStock),attributes:f?void 0:r(K,{name:"Attributes",slot:l==null?void 0:l.Attributes,context:{...k},children:le!=null&&le.length?V(Pe,{children:[E,r("ul",{children:le})]}):null}),galleryContent:(l==null?void 0:l.GalleryContent)&&r(K,{name:"GalleryContent",slot:l.GalleryContent,context:{...k}}),infoContent:(l==null?void 0:l.InfoContent)&&r(K,{name:"InfoContent",slot:l.InfoContent,context:{...k}}),productContent:(l==null?void 0:l.Content)&&r(K,{name:"Content",slot:l.Content,context:{...k}})})})};ut.getInitialData=async function({sku:e,optionsConfig:o}){var p,s,f,h,b,l;const d=((p=ot().optionsUIDs)==null?void 0:p.split(","))||((l=(b=(h=(f=(s=Te)==null?void 0:s.getConfig())==null?void 0:f.models)==null?void 0:h.ProductDetails)==null?void 0:b.initialData)==null?void 0:l.optionsUIDs);return d!=null&&d.length?await Re(e,d,o==null?void 0:o.anchorOptions):await $e(e)};export{ut as ProductDetails,ut as default};
