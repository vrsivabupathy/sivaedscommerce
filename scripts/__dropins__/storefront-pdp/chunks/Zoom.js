import{jsxs as z,jsx as C,Fragment as _e}from"@dropins/tools/preact-jsx-runtime.js";import*as V from"@dropins/tools/preact-compat.js";import{useState as W,Children as B,useRef as he,useMemo as be,useEffect as S,useCallback as U}from"@dropins/tools/preact-compat.js";import{debounce as ve,classes as M}from"@dropins/tools/lib.js";import{Button as de,Icon as Ne}from"@dropins/tools/components.js";/* empty css     */import{useText as T}from"@dropins/tools/i18n.js";import{cloneElement as Ee}from"@dropins/tools/preact.js";const We=i=>V.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...i},V.createElement("path",{d:"M7.74512 9.87701L12.0001 14.132L16.2551 9.87701",stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"square",strokeLinejoin:"round"})),Le=i=>V.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...i},V.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M18.3599 5.64001L5.62988 18.37",stroke:"currentColor"}),V.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M18.3599 18.37L5.62988 5.64001",stroke:"currentColor"})),ke=24,ye=16,H=2,De="32";var Ce=(i=>(i[i.small=16]="small",i[i.medium=24]="medium",i[i.large=64]="large",i))(Ce||{});const He=({show:i=1,scrollbar:w=!1,peak:y=!1,arrows:p=!1,controls:a="dots",arrowsOnMainImage:E=!1,loop:s=!1,gap:m=null,direction:k="horizontal",width:X="100%",height:ne="100%",defaultIndex:D=0,className:le,children:x,thumbnails:Y=null,isZoomed:I,...J})=>{const Q=T("PDP.Carousel.label").label,G=T("PDP.Carousel.Slide.label").label,ee=T("PDP.Carousel.Previous.label").label,te=T("PDP.Carousel.Next.label").label,ae=T("PDP.Carousel.Controls.label").label,oe=T("PDP.Carousel.Controls.Button.label").label,[h,ce]=W(()=>we(i)),o=Math.ceil(B.count(x)/h),d=y?ke:0,g=m?Ce[m]:0,P=B.count(x)%h,[c,O]=W(s?L()?D-1:D+1:D),$=he([]),[Z,ie]=W(0),[j,Me]=W(0),fe=be(()=>B.toArray(Y),[Y]),_=be(()=>{const e=B.toArray(x).reduce((t,n,r)=>r%h===0?[...t,[n]]:[...t.slice(0,-1),[...t[t.length-1],n]],[]);return!s||e.length===1?e:s&&B.count(x)%h===0?[e[o-1]].concat(e).concat([e[0],e[1]]):[B.toArray(x).slice(-h)].concat(e).concat([e[0],e[1]])},[x,h,o,s]),R=he(null),pe=he(null),b=a==="thumbnailsRow"||a==="thumbnailsColumn";S(()=>{const e=document.body,t=ve(()=>{var l,N;ie(((l=R.current)==null?void 0:l.offsetWidth)??0),Me(((N=R.current)==null?void 0:N.offsetHeight)??0);const r=window.innerWidth,u=we(i,r);u!==h&&ce(u)},50),n=new ResizeObserver(t);return n.observe(e),()=>{n.unobserve(e)}},[h,i]);const F=U(e=>{const t=s?e-1:e,n=$==null?void 0:$.current[0],r=(n==null?void 0:n.offsetWidth)+ye,u=(n==null?void 0:n.offsetHeight)+ye,l=pe.current,N=a==="thumbnailsRow",se=a==="thumbnailsColumn",A=N?l==null?void 0:l.offsetWidth:l==null?void 0:l.offsetHeight,f=N?r:u;(N||se)&&A&&(f*(t+1)>A&&(l.style.scrollBehavior="smooth",N?l.scrollLeft=L()?l.scrollWidth-l.clientWidth-(t+H)*f:(t+H)*f:l.scrollTop=(t+H)*f),(L()&&(N?l.scrollLeft:l.scrollTop)<=-f*t||!L()&&(N?l.scrollLeft:l.scrollTop)>f*t)&&(l.style.scrollBehavior="smooth",N?l.scrollLeft=L()?-(t-H)*f:(t-H)*f:l.scrollTop=(t-H)*f))},[a,s]);S(()=>{F(c)},[c,F]);const v=U((e,t,n)=>{b&&F(e);const r=R.current,u=d?r.offsetWidth-d:r.offsetWidth-d+g;if(!Array.from(r.querySelectorAll("[data-index]")).filter(A=>{const f=Number(A.getAttribute("data-index"));return!isNaN(f)&&f>-1})[e])return;if(n){const A=e===0?o:0,f=u*(o+(P||h)/h);if(L()){if(r.scrollLeft<=0&&r.scrollLeft>-(u-5)){v(1,!0);return}if(r.scrollLeft<u-f&&r.scrollLeft>=-f){v(o,!0);return}r.style.scrollBehavior="auto",r.scrollLeft=A===0?0:-f,v(A===0?1:o,!0)}else{if(r.scrollLeft>=0&&r.scrollLeft<u-5){v(1,!0);return}if(r.scrollLeft>f-u&&r.scrollLeft<=f){v(o,!0);return}r.style.scrollBehavior="auto",r.scrollLeft=A===0?0:f,v(A===0?1:o,!0);return}}const se=(r.offsetWidth-g)/h*_[e].length-d;r.style.scrollBehavior=t?"smooth":"auto",r.scrollLeft=L()?-(_[e].length===h?u*e:u*(e-1)-se):_[e].length===h?u*e:u*(e-1)+se},[g,o,d,h,P,_,F,a]),K=U(()=>{if(s){const t=c-1;v(t,!0,L()?c===o-1:c===1);return}const e=c<=0?0:c-1;v(e,!0)},[c,v,s]),q=U(()=>{const e=_.length-1;if(s){const n=c+1;v(n,!0,L()?c===0:c===o);return}const t=c>=e?e:c+1;v(t,!0)},[_.length,s,c,v,o]);S(()=>{const e=t=>{t.key==="ArrowLeft"&&(t.preventDefault(),L()?q():K()),t.key==="ArrowRight"&&(t.preventDefault(),L()?K():q())};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[q,K]),S(()=>{v(s?D+1:D,!1)},[D,v,s]);const ue=ve(()=>{const e=R.current,t=d?e.offsetWidth-d:e.offsetWidth-d+g,n=Math.abs(e.scrollLeft)/t,r=Math.abs(Math.round(n)-n<1?Math.round(n):Math.ceil(n));if(b&&F(r),s){const u=t*(o+(P||h)/h),l=L()?-e.scrollLeft:e.scrollLeft;if(Math.ceil(Math.abs(l))>=Math.ceil(u)-5){e.style.scrollBehavior="auto",e.scrollLeft=L()?-e.offsetWidth+(Math.ceil(l)-Math.ceil(u)-d):e.offsetWidth+(Math.ceil(l)-Math.ceil(u)-d);return}if(Math.abs(l)===0){e.style.scrollBehavior="auto",e.scrollLeft=L()?-(u-e.offsetWidth+d):u-e.offsetWidth+d;return}}c!==r&&O(r)},100);S(()=>{const e=R.current;return e==null||e.addEventListener("scroll",ue),()=>{e==null||e.removeEventListener("scroll",ue)}},[ue]);const re=(e,t,n)=>C(de,{className:M([["pdp-carousel__button",!e],[`pdp-carousel__button--${t}`,!e],[`pdp-carousel__button--${a}`,e]]),style:{"--height":`${j}px`},variant:"tertiary","aria-label":t==="next"?te:ee,onClick:n,disabled:s?!1:t==="next"?c>=_.length-1:c<1,children:C(Ne,{className:M([["pdp-carousel__button__icon",!e],[`pdp-carousel__button__icon--${t}`,!e],[`pdp-carousel__button__icon--${a}--${t}`,e]]),size:De,source:We})}),me=p&&_.length!=1&&re(b,"prev",K),ge=p&&_.length!=1&&re(b,"next",q),Pe=p&&_.length!=1&&re(!1,"prev",K),xe=p&&_.length!=1&&re(!1,"next",q);return z("div",{role:"region","aria-roledescription":Q,className:M(["pdp-carousel",["pdp-carousel--main-image-controls",E],["pdp-carousel--arrows",p&&!b],[`pdp-carousel--${a}`,b],le]),style:{"--flex-carousel":a==="thumbnailsColumn"?"row-reverse":"column","--gap":b?"0":"var(--spacing-small)","--width":X},...J,children:[C("div",{ref:R,className:M(["pdp-carousel__wrapper",`pdp-carousel__wrapper--${k}`,["pdp-carousel__wrapper--scrollbar",w],["pdp-carousel__wrapper--peak",y]]),style:{"--total-width":a==="thumbnailsColumn"?"81.6%":"100%","--height":a==="thumbnailsColumn"?"auto":ne,"--gap":m?`var(--spacing-${m})`:"0px","--per-page":h},tabIndex:0,children:_.map((e,t)=>{const n=e.length<h;return C("div",{role:"group","aria-roledescription":G,"data-index":t,className:M(["pdp-carousel__slide",`pdp-carousel__slide--${k}`,["pdp-carousel__slide--active",c===t],["pdp-carousel__slide--orphan",n]]),style:{"--length":e.length},children:e},t)})}),!b&&z(_e,{children:[me,ge]}),b&&E&&z(_e,{children:[Pe,xe]}),a&&_.length!=1&&z("div",{className:M([[`pdp-carousel__controls__container--${a}`,b],["pdp-carousel__controls__container--no-arrows",!p||E]]),style:{"--width":a==="thumbnailsRow"?`${Z}px`:X,"--height":`${j}px`,"--nr-thumbnails":fe.length},children:[(b||I)&&!E&&me,C("div",{ref:pe,className:M([[`pdp-carousel__controls__wrapper--${a}`,b],["pdp-carousel__controls__wrapper",b]]),children:C("div",{role:"group","aria-label":ae,className:M(["pdp-carousel__controls",[`pdp-carousel__controls--${a}`,b]]),children:(s?_.slice(0,o):_).map((e,t)=>{const n=s?o:_.length,r=s?c-1===t:c===t;return b?z("label",{className:M(["pdp-carousel__thumbnail__container"]),ref:u=>{u&&($.current[t]=u)},children:[C("input",{type:"radio",name:"carousel-thumbnails","aria-label":oe.replace("{key}",String(t+1)).replace("{total}",String(n)),checked:r&&Z!==0,onChange:()=>{v(s?t+1:t,!0)},...J,className:M(["pdp-carousel__thumbnail",["pdp-carousel__thumbnail--selected",r&&Z!==0]])}),C("span",{className:M(["pdp-carousel__thumbnail__span"]),children:fe[t]})]},t):C("button",{"aria-label":oe.replace("{key}",String(t+1)).replace("{total}",String(n)),onClick:()=>{v(s?t+1:t,!0)},className:M(["pdp-carousel__controls__button",["pdp-carousel__controls__button--active",r]])},t)})})}),(b||I)&&!E&&ge]})]})};function we(i,w=0){if(typeof i=="number")return i;const{small:y,medium:p,large:a}=i,s=[{breakpoint:1024,value:a},{breakpoint:786,value:p},{breakpoint:0,value:y}].find(({breakpoint:m})=>w>m);return s?s.value:y}function L(){return document.documentElement.dir==="rtl"}const Xe=({centered:i,onClose:w,className:y,children:p,...a})=>{const E=T("PDP.Overlay.Close.label").label,s=U(()=>{w==null||w()},[w]);return S(()=>{const m=k=>{k.key==="Escape"&&s()};return document.addEventListener("keydown",m),()=>{document.removeEventListener("keydown",m)}},[s]),S(()=>{const m=document.scrollingElement,k=m.style.overflow;return m.style.overflow="hidden",()=>{m.style.overflow=k}},[]),z("div",{...a,className:M(["pdp-overlay",["pdp-overlay--centered",i],y]),children:[C("div",{className:"pdp-overlay__content",children:p}),C(de,{"aria-label":E,variant:"tertiary",className:"pdp-overlay__close-button",onClick:s,icon:C(Le,{})})]})},Ye=({children:i,scale:w=2,closeButton:y=!0})=>{const[p,a]=W(!1),[E,s]=W("pdp-zoom"),[m,k]=W(!1),[X,ne]=W({x:0,y:0}),[D,le]=W({x:0,y:0}),[x,Y]=W({x:0,y:0}),I=o=>{!p||o.type!=="touchstart"||(ne({x:o.touches[0].clientX,y:o.touches[0].clientY}),le({x:x.x,y:x.y}),k(!0))},J=o=>{var j;if(!m||o.type!=="touchmove")return;const d=(j=o.currentTarget)==null?void 0:j.getBoundingClientRect(),g=(100-100/w)/2,P=o.touches[0].clientX-X.x,c=o.touches[0].clientY-X.y,O=P*100/(d.width*w),$=c*100/(d.height*w),Z=D.x+O,ie=D.y+$;Y({x:Math.max(-g,Math.min(Z,g))||0,y:Math.max(-g,Math.min(ie,g))||0}),o.preventDefault()},Q=o=>{var $;const d=($=o.currentTarget)==null?void 0:$.getBoundingClientRect(),g=(100-100/w)/2;let P;if("touches"in o)P=o.touches[0];else if(o instanceof MouseEvent)P=o;else return;const c=g-(P.clientX-d.left)/d.width*100,O=g-(P.clientY-d.top)/d.height*100;Y({x:Math.max(-g,Math.min(c,g))||0,y:Math.max(-g,Math.min(O,g))||0})},G=o=>{if(!m){if(p){if(y&&"touches"in o){I(o);return}y||a(!1)}else a(!0),Q(o);o.preventDefault()}},ee=o=>{if(y&&"touches"in o){J(o);return}p&&Q(o)},te=()=>{if(y){k(!1);return}a(!1)},ae=o=>{a(!1),o.stopPropagation()},oe=p?`scale(${w}) translateX(${x.x}%) translateY(${x.y}%)`:"none",h=T("PDP.Zoom.Close.label").label,ce=Ee(B.only(i),{draggable:!1,style:{"--transform":oe}});return S(()=>{s(p?`pdp-zoom ${y?"pdp-zoom--no-effects":"pdp-zoom--zoomed"}`:"pdp-zoom")},[p,y]),z("figure",{className:E,onClick:G,onMouseMove:ee,onMouseLeave:te,onTouchStart:G,onTouchMove:ee,onTouchEnd:te,children:[ce,y&&p&&C(de,{"aria-label":h,variant:"tertiary",className:"pdp-zoom__close-button",icon:C(Le,{}),onClick:ae})]})};export{He as C,Xe as O,Ye as Z};
