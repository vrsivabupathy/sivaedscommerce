import{jsxs as S,jsx as d,Fragment as V}from"@dropins/tools/preact-jsx-runtime.js";import{useCallback as D,useRef as v,useState as N,useEffect as R}from"@dropins/tools/preact-hooks.js";import{classes as b}from"@dropins/tools/lib.js";import{Button as _,Field as k,Picker as O,Input as y,InputDate as H,Checkbox as P,TextArea as q}from"@dropins/tools/components.js";import{initReCaptcha as U}from"@dropins/tools/recaptcha.js";import{useText as W}from"@dropins/tools/i18n.js";import*as p from"@dropins/tools/preact-compat.js";import{memo as G,useCallback as g}from"@dropins/tools/preact-compat.js";const te=r=>{if(!r)return null;const c=new FormData(r);if(c&&typeof c.entries=="function"){const u=c.entries();if(u&&typeof u[Symbol.iterator]=="function")return JSON.parse(JSON.stringify(Object.fromEntries(u)))||{}}return{}},ne=r=>typeof r=="function",ae=({type:r,buttonText:c,variant:u,className:s="",enableLoader:o=!1,onClick:l,style:h,icon:a,...i})=>{const T=D(A=>{l==null||l(A)},[l]);return S(_,{icon:a,style:h,type:r,variant:u,className:b(["auth-button",s,o?"enableLoader":""]),onClick:T,...i,children:[d("span",{className:"auth-button__text",children:c}),o?d("div",{className:"auth-button__loader-wrapper",children:d("span",{className:"auth-button__loader"})}):null]})},C=r=>r.reduce((c,{code:u,required:s,defaultValue:o})=>(s&&(c[u]=o),c),{}),F=({fieldsConfig:r,submitCallback:c})=>{const{requiredFieldError:u}=W({requiredFieldError:"Auth.FormText.requiredFieldError"}),s=v(null),o=v(!1),[l,h]=N({}),[a,i]=N({}),T=D(async()=>{o.current||(await U(0),o.current=!0)},[]);R(()=>{if(!r.length)return;const t=C(r);h(t)},[r==null?void 0:r.length]);const $=D((t,n)=>{const E=r.find(f=>f.code===t);return E!=null&&E.required&&!n?u:""},[r,u]),A=D(t=>{const{name:n,value:E,type:I,checked:f}=t==null?void 0:t.target,x=I==="checkbox"?f:E;h(L=>({...L,[n]:x}))},[]),M=D(t=>{const{name:n,value:E,type:I,checked:f}=t==null?void 0:t.target,x=I==="checkbox"?f:E;i(L=>({...L,[n]:$(n,x)}))},[$]),e=D(t=>{t.preventDefault();let n=!0,E={},I=null;for(const[f,x]of Object.entries(l)){const L=$(f,x);L&&(E[f]=L,n=!1,I||(I=f))}if(i(E),I&&s.current){const f=s.current.elements.namedItem(I);f==null||f.focus()}c==null||c(t,n)},[l,$,c]);return{formData:l,errors:a,formRef:s,handleChange:A,handleBlur:M,handleSubmit:e,handleFocus:T}};var w=(r=>(r.BOOLEAN="BOOLEAN",r.DATE="DATE",r.DATETIME="DATETIME",r.DROPDOWN="DROPDOWN",r.FILE="FILE",r.GALLERY="GALLERY",r.HIDDEN="HIDDEN",r.IMAGE="IMAGE",r.MEDIA_IMAGE="MEDIA_IMAGE",r.MULTILINE="MULTILINE",r.MULTISELECT="MULTISELECT",r.PRICE="PRICE",r.SELECT="SELECT",r.TEXT="TEXT",r.TEXTAREA="TEXTAREA",r.UNDEFINED="UNDEFINED",r.VISUAL="VISUAL",r.WEIGHT="WEIGHT",r.EMPTY="",r))(w||{});const Z=G(({loading:r,values:c,fields:u=[],errors:s,className:o="",onChange:l,onBlur:h})=>{const a=`${o}__field`,i=g((e,t,n)=>d(k,{error:n,className:b([a,`${a}--${e.id}`,[`${a}--${e.id}-hidden`,e.hidden],e.className]),"data-testid":`${o}--${e.id}`,disabled:r,children:d(O,{name:e.id,floatingLabel:`${e.label} ${e.required?"*":""}`,placeholder:e.label,"aria-label":e.label,options:e.options.map(E=>({...E,text:E.label})),onBlur:h,handleSelect:l,value:t||e.defaultValue})},e.id),[o,r,a,h,l]),T=g((e,t,n)=>d(k,{error:n,className:b([a,`${a}--${e.id}`,[`${a}--${e.id}-hidden`,e.hidden],e.className]),"data-testid":`${o}--${e.id}`,disabled:r,children:d(y,{autocomplete:e.code==="email"?"username":"",type:"text",name:e.id,value:t===void 0?e.defaultValue:t,placeholder:e.label,floatingLabel:`${e.label} ${e.required?"*":""}`,onBlur:h,onChange:l})},e.id),[o,r,a,h,l]),$=g((e,t,n)=>d(k,{error:n,className:b([a,`${a}--${e.id}`,[`${a}--${e.id}-hidden`,e.hidden],e.className]),"data-testid":`${o}--${e.id}`,disabled:r,children:d(H,{type:"text",name:e.id,value:t||e.defaultValue,placeholder:e.label,floatingLabel:`${e.label} ${e.required?"*":""}`,onBlur:h,onChange:l})},e.id),[o,r,a,h,l]),A=g((e,t,n)=>d(k,{error:n,className:b([a,`${a}--${e.id}`,[`${a}--${e.id}-hidden`,e.hidden],e.className]),"data-testid":`${o}--${e.id}`,disabled:r,children:d(P,{name:e.id,checked:t||e.defaultValue,placeholder:e.label,label:`${e.label} ${e.required?"*":""}`,onBlur:h,onChange:l})},e.id),[o,r,a,h,l]),M=g((e,t,n)=>d(k,{error:n,className:b([a,`${a}--${e.id}`,[`${a}--${e.id}-hidden`,e.hidden],e.className]),"data-testid":`${o}--${e.id}`,disabled:r,children:d(q,{type:"text",name:e.id,value:t===void 0?e.defaultValue:t,label:`${e.label} ${e.required?"*":""}`,onBlur:h,onChange:l})},e.id),[o,r,a,h,l]);return u.length?d(V,{children:u.map(e=>{const t=(s==null?void 0:s[e.id])??void 0,n=(c==null?void 0:c[e.id])??void 0;switch(e.fieldType){case w.TEXT:return e.options.length?i(e,n,t):T(e,n,t);case w.MULTILINE:return T(e,n,t);case w.SELECT:return i(e,n,t);case w.DATE:return $(e,n,t);case w.BOOLEAN:return A(e,n,t);case"TEXTAREA":return M(e,n,t);default:return null}})}):null}),oe=({name:r,isLoading:c,children:u,className:s="defaultForm",fieldsConfig:o=[],submitCallback:l})=>{const{formData:h,errors:a,formRef:i,handleChange:T,handleBlur:$,handleSubmit:A,handleFocus:M}=F({submitCallback:l,fieldsConfig:o});return S("form",{onSubmit:A,className:s,name:r,ref:i,onFocus:M,children:[d(Z,{fields:o,onChange:T,onBlur:$,errors:a,values:h,className:s,loading:c}),u]})},B=r=>p.createElement("svg",{id:"Icon_Warning_Base",width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...r},p.createElement("g",{clipPath:"url(#clip0_841_1324)"},p.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M11.9949 2.30237L0.802734 21.6977H23.1977L11.9949 2.30237Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),p.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M12.4336 10.5504L12.3373 14.4766H11.6632L11.5669 10.5504V9.51273H12.4336V10.5504ZM11.5883 18.2636V17.2687H12.4229V18.2636H11.5883Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})),p.createElement("defs",null,p.createElement("clipPath",{id:"clip0_841_1324"},p.createElement("rect",{width:24,height:21,fill:"white",transform:"translate(0 1.5)"})))),X=r=>p.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...r},p.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M0.75 12C0.75 5.78421 5.78421 0.75 12 0.75C18.2158 0.75 23.25 5.78421 23.25 12C23.25 18.2158 18.2158 23.25 12 23.25C5.78421 23.25 0.75 18.2158 0.75 12Z",stroke:"currentColor"}),p.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M6.75 12.762L10.2385 15.75L17.25 9",stroke:"currentColor"})),j=r=>p.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...r},p.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M0.75 12C0.75 5.78421 5.78421 0.75 12 0.75C18.2158 0.75 23.25 5.78421 23.25 12C23.25 18.2158 18.2158 23.25 12 23.25C5.78421 23.25 0.75 18.2158 0.75 12Z",stroke:"currentColor"}),p.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M11.75 5.88423V4.75H12.25V5.88423L12.0485 13.0713H11.9515L11.75 5.88423ZM11.7994 18.25V16.9868H12.2253V18.25H11.7994Z",stroke:"currentColor"})),Y={success:d(X,{}),warning:d(B,{}),error:d(j,{})},ce=()=>{const[r,c]=N({}),u=D(s=>{if(!s||!s.type){c({});return}const o=Y[s.type];c({...s,icon:o})},[]);return{inLineAlertProps:r,handleSetInLineAlertProps:u}};export{ae as B,oe as F,ne as c,te as g,ce as u};
