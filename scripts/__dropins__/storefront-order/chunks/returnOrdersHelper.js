/*! Copyright 2024 Adobe
All Rights Reserved. */
import{F as c}from"./form.types.js";const p={PENDING:"pending",AUTHORIZED:"authorized",PARTIALLY_AUTHORIZED:"partiallyAuthorized",RECEIVED:"received",PARTIALLY_RECEIVED:"partiallyReceived",APPROVED:"approved",PARTIALLY_APPROVED:"partiallyApproved",REJECTED:"rejected",PARTIALLY_REJECTED:"partiallyRejected",DENIED:"denied",PROCESSED_AND_CLOSED:"processedAndClosed",CLOSED:"closed"},y=n=>{const s={};return Object.keys(n).forEach(t=>{if(t.match(/_(\d+)$/)){const e=t.replace(/_\d+$/,"");s[e]=n[t]}else s[t]=n[t]}),s},R=(n,s)=>n.map(t=>({...t,id:`${t.id}_${t.fieldType}_${s+1}`,name:`${t.name}_${t.fieldType}_${s+1}`,code:`${t.code}_${t.fieldType}_${s+1}`,customUpperCode:`${t.customUpperCode}_${t.fieldType}_${s+1}`})),_=(n,s)=>n==null?void 0:n.flatMap(t=>Array.from({length:s},(i,e)=>({...t,id:`${t.id}_${t.fieldType}_${e+1}`,name:`${t.name}_${t.fieldType}_${e+1}`,code:`${t.code}_${t.fieldType}_${e+1}`,customUpperCode:`${t.customUpperCode}_${t.fieldType}_${e+1}`}))),$=n=>{const s=[],t=[];return Object.entries(n).forEach(([i,e])=>{const a=i.lastIndexOf("_"),r=i.slice(0,a),u=i.slice(a+1);u===c.MULTISELECT||u===c.SELECT?s.push({attributeCode:r,value:btoa(e)}):t.push({attributeCode:r,value:e})}),{selectedCustomAttributes:s,enteredCustomAttributes:t}},A=n=>typeof n!="string"?"":p[n]??"",l=["REJECTED","PARTIALLY_REJECTED","DENIED","UNCONFIRMED","CLOSED"],C=n=>{const s=n==null?void 0:n.returns.filter(e=>!l.includes(e.returnStatus));return((n==null?void 0:n.itemsEligibleForReturn)??[]).flatMap(e=>{let a=e.quantityShipped,r={...e,returnableQuantity:a};return e.quantityShipped===0&&(r={...r,eligibleForReturn:!1,returnableQuantity:0}),s.forEach(u=>{u.items.forEach(o=>{if((o==null?void 0:o.id)===(e==null?void 0:e.id)){const d=a-o.requestQuantity;a=Math.max(d,0),r={...r,eligibleForReturn:a!==0,returnableQuantity:a}}})}),r}).sort((e,a)=>Number(a.eligibleForReturn)-Number(e.eligibleForReturn))},m=n=>{var i;let s=[];const t=(i=n==null?void 0:n.returns)==null?void 0:i.filter(e=>!l.includes(e.returnStatus)).flatMap(e=>e.items||[]);return t==null||t.forEach(e=>{if(!s.length)s.push({...e,totalQuantity:e.requestQuantity});else{const a=s.findIndex(r=>r.id===e.id);a!==-1?s[a].totalQuantity+=e.requestQuantity:s.push({...e,totalQuantity:e.requestQuantity})}}),{returnedList:s??[],modifyOrder:E(n.items,s)??[]}};function E(n,s){const t=new Map(s.map(i=>[i.id,i]));return n.map(i=>{const e=t.get(i.id);if(e){const a=i.totalQuantity-e.totalQuantity;return a===0?null:{...i,totalQuantity:a}}return i}).filter(i=>i!==null)}export{y as c,m as e,A as f,R as m,$ as n,C as o,_ as r};
