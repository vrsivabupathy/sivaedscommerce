function mergeDeep(...objects){const isObject=obj=>obj&&typeof obj==="object";return objects.reduce(((prev,obj)=>{for(const key in obj){const pVal=prev[key];const oVal=obj[key];if(Array.isArray(pVal)&&Array.isArray(oVal)){prev[key]=pVal.concat(...oVal)}else if(isObject(pVal)&&isObject(oVal)){prev[key]=mergeDeep(pVal,oVal)}else{prev[key]=oVal}}return prev}),{})}function getValueByPath(obj,path){const keys=path.split(".");let value=obj;for(let key of keys){value=value[key];if(value===undefined){return undefined}}return value}function triggerEventsRetroactively(event,handler,options){if(event==="adobeDataLayer:change"){let dataItems=window.adobeDataLayer.filter((e=>typeof e!=="function"&&!e.event));if(options&&options.path){dataItems=dataItems.filter((e=>getValueByPath(e,options.path)!==undefined))}dataItems.forEach((e=>handler(e)));return}let events=window.adobeDataLayer.filter((e=>typeof e!=="function"&&e.event));if(event!=="adobeDataLayer:event"){events=events.filter((e=>e.event===event))}events.forEach((e=>handler(e)))}function triggerHandlers(item){let handlers=[];if(item.event){handlers.push(...window.adobeDataLayer._eventListeners["adobeDataLayer:event"]||[]);handlers.push(...window.adobeDataLayer._eventListeners[item.event]||[])}else{handlers.push(...window.adobeDataLayer._eventListeners["adobeDataLayer:change"]||[])}handlers.forEach((h=>{if(h.options&&h.options.path&&!getValueByPath(item,h.options.path)){return}h.handler(item)}))}window.adobeDataLayer._eventListeners={};window.adobeDataLayer.getState=function(path,time){const lists=[];if(time==="past"&&!window.acdlDisableStorage){const keys=Object.keys(window.sessionStorage).filter((a=>a.startsWith("acdl:"))).filter((a=>a!==`acdl:${window.acdlIndex}`)).sort(((a,b)=>a.localeCompare(b,"en",{numeric:true})));keys.forEach((key=>{lists.push(JSON.parse(window.sessionStorage.getItem(key)))}))}else if(!isNaN(time)&&!window.acdlDisableStorage){const index=window.acdlIndex+time;lists.push(JSON.parse(window.sessionStorage.getItem(`acdl:${index}`))||[])}else if(Array.isArray(time)&&time.length===2&&time.every((t=>!isNaN(t)))&&!window.acdlDisableStorage){let indexes=[];for(let i=time[0];i<=time[1];i++){indexes.push(window.acdlIndex+i)}indexes.forEach((index=>{lists.push(JSON.parse(window.sessionStorage.getItem(`acdl:${index}`))||[])}))}else{lists.push(window.adobeDataLayer.filter((a=>typeof a!=="function")))}let state={};const list=lists.flat();list.forEach((item=>{state=mergeDeep(state,item)}));delete state.event;delete state.eventInfo;state.events=list.filter((e=>e.event));if(path){return getValueByPath(state,path)}return state};window.adobeDataLayer.addEventListener=function(event,handler,options){window.adobeDataLayer._eventListeners[event]=(window.adobeDataLayer._eventListeners[event]||[]).concat({handler:handler,options:options});triggerEventsRetroactively(event,handler,options)};window.adobeDataLayer.removeEventListener=function(event,handler){window.adobeDataLayer._eventListeners[event]=(window.adobeDataLayer._eventListeners[event]||[]).filter((c=>c.handler!==handler))};const oldPush=window.adobeDataLayer.push;window.adobeDataLayer.push=function(...args){args.filter((a=>typeof a==="function")).forEach((function(func){func(this)}),window.adobeDataLayer);const others=args.filter((a=>typeof a!=="function"));oldPush(...others);others.forEach((arg=>triggerHandlers(arg)))};window.adobeDataLayer.forEach((function(func){if(typeof func!=="function"){return}func(this)}),window.adobeDataLayer);window.adobeDataLayer.forEach(((a,index)=>typeof a==="function"&&window.adobeDataLayer.splice(index,1)));